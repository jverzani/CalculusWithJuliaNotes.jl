{
  "hash": "7317e93a149e9ec056ededf2a071699c",
  "result": {
    "markdown": "# Implicit Differentiation\n\n\n\nThis section uses these add-on packages:\n\n``` {.julia .cell-code}\nusing CalculusWithJulia\nusing Plots\nusing ImplicitPlots\nusing Roots\nusing SymPy\n```\n\n\n\n\n---\n\n\n## Graphs of equations\n\n\nAn **equation** in $y$ and $x$ is an algebraic expression involving an equality with two (or more) variables. An example might be $x^2 + y^2 = 1$.\n\n\nThe **solutions** to an equation in the variables $x$ and $y$ are all points $(x,y)$ which satisfy the equation.\n\n\nThe **graph** of an equation is just the set of solutions to the equation represented in the Cartesian plane.\n\n\nWith this definition, the graph of a function $f(x)$ is just the graph of the equation $y = f(x)$. In general, graphing an equation is more complicated than graphing a function. For a function, we know for a given value of $x$ what the corresponding value of $f(x)$ is through evaluation of the function. For equations, we may have $0$, $1$ or more $y$ values for a given $x$ and even more problematic is we may have no rule to find these values.\n\n\nThere are a few options for plotting  equations in `Julia`. We will use `ImplicitPlots` in this section, but note both `ImplicitEquations` and `IntervalConstraintProgramming` offer alternatives that are a bit more flexible.\n\n\nTo plot an implicit equation using `ImplicitPlots` requires expressing the relationship in terms of a function, and then plotting the equation `f(x,y) = 0`. In practice this simply requires all the terms be moved to one side of an equals sign.\n\n\nTo plot the circle of radius $2$, or the equations $x^2 + y^2 = 2^2$ we would move all terms to one side $x^2 + y^2 - 2^2 = 0$ and then express the left hand side through a function:\n\n::: {.cell execution_count=4}\n``` {.julia .cell-code}\nf(x,y) = x^2 + y^2 - 2^2\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\nf (generic function with 1 method)\n```\n:::\n:::\n\n\nThis function is then is passed to the `implicit_plot` function, which works with `Plots` to render the graphic:\n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\nimplicit_plot(f)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n![](implicit_differentiation_files/figure-html/cell-6-output-1.svg){}\n:::\n:::\n\n\n:::{.callout-note}\n## Note\nThe `f` is a function of *two* variables, used here to express one side of an equation. `Julia` makes this easy to do - just make sure two variables are in the signature of `f` when it is defined. Using functions like this, we can express our equation in the form $f(x,y) = c$ or, more generally, as $f(x,y) = g(x,y)$. The latter of which can be expressed as $h(x,y) = f(x,y) - g(x,y) = 0$. That is, only the form $f(x,y)=0$ is needed to represent an equation.\n\n:::\n\n:::{.callout-note}\n## Note\nThere are two different styles in `Julia` to add simple plot recipes. `ImplicitPlots` adds a new plotting function (`implicit_plot`); alternatively many packages add a new recipe for the generic `plot` method using new types. (For example, `SymPy` has a plot recipe for symbolic types.\n\n:::\n\nOf course, more complicated equations are possible and the steps are similar - only the function definition is more involved.  For example, the [Devils curve](http://www-groups.dcs.st-and.ac.uk/~history/Curves/Devils.html) has the form\n\n\n\n$$\ny^4 - x^4 + ay^2 + bx^2 = 0\n$$\n\n\nHere we draw the curve for a particular choice of $a$ and $b$. For illustration purposes, a narrower viewing window is specified below using `xlims` and `ylims`:\n\n::: {.cell hold='true' execution_count=6}\n``` {.julia .cell-code}\na,b = -1,2\nf(x,y) =  y^4 - x^4 + a*y^2 + b*x^2\nimplicit_plot(f; xlims=(-3,3), ylims=(-3,3), legend=false)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n![](implicit_differentiation_files/figure-html/cell-7-output-1.svg){}\n:::\n:::\n\n\n## Tangent lines, implicit differentiation\n\n\nThe graph $x^2 + y^2 = 1$ has well-defined tangent lines at all points except $(-1,0)$ and $(0, 1)$ and even at these two points, we could call the vertical lines $x=-1$ and $x=1$ tangent lines. However, to recover the slope of these tangent lines would need us to express $y$ as a function of $x$ and then differentiate that function. Of course, in this example, we would need two functions: $f(x) = \\sqrt{1-x^2}$ and $g(x) = - \\sqrt{1-x^2}$ to do this completely.\n\n\nIn general though, we may not be able to solve for $y$ in terms of $x$. What then?\n\n\nThe idea is to *assume* that $y$ is representable by some function of $x$. This makes sense, moving on the curve from $(x,y)$ to some nearby point, means changing $x$ will cause some change in $y$. This assumption is only made *locally* - basically meaning a complicated graph is reduced to just a small, well-behaved, section of its graph.\n\n\nWith this assumption, asking what $dy/dx$ is has an obvious meaning - what is the slope of the tangent line to the graph at $(x,y)$. (The assumption eliminates the question of what a tangent line would  mean when a graph self intersects.)\n\n\nThe method of implicit differentiation allows this question to be investigated. It begins by differentiating both sides of the equation assuming $y$ is a function of $x$ to derive a new equation involving $dy/dx$.\n\n\nFor example,  starting with $x^2 + y^2 = 1$, differentiating both sides in $x$ gives:\n\n\n\n$$\n2x + 2y\\cdot \\frac{dy}{dx} = 0.\n$$\n\n\nThe chain rule was used to find $(d/dx)(y^2) = [y(x)^2]' = 2y \\cdot dy/dx$. From this we can solve for $dy/dx$ (the resulting equations are linear in $dy/dx$, so can always be solved explicitly):\n\n\n\n$$\n\\frac{dy}{dx} = -\\frac{x}{y}.\n$$\n\n\nThis says the slope of the tangent line depends on the point $(x,y)$ through the formula $-x/y$.\n\n\nAs a check, we compare to what we would have found had we solved for $y= \\sqrt{1 - x^2}$ (for $(x,y)$ with $y \\geq 0$). We would have found: $dy/dx = 1/2 \\cdot 1/\\sqrt{1 - x^2} \\cdot (-2x)$. Which can be simplified to $-x/y$. This should show that the method above - assuming $y$ is a function of $x$ and differentiating - is not only more general, but can even be easier.\n\n\nThe name - *implicit differentiation* - comes from the assumption that $y$ is implicitly defined in terms of $x$.  According to the [Implicit Function Theorem](http://en.wikipedia.org/wiki/Implicit_function_theorem) the above method will work provided the curve has sufficient smoothness near the point $(x,y)$.\n\n\n##### Examples\n\n\nConsider the [serpentine](http://www-history.mcs.st-and.ac.uk/Curves/Serpentine.html) equation\n\n\n\n$$\nx^2y + a\\cdot b \\cdot y - a^2 \\cdot x = 0, \\quad a\\cdot b > 0.\n$$\n\n\nFor $a = 2, b=1$ we have the graph:\n\n::: {.cell hold='true' execution_count=7}\n``` {.julia .cell-code}\na, b = 2, 1\nf(x,y) = x^2*y + a * b * y - a^2 * x\nimplicit_plot(f)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n![](implicit_differentiation_files/figure-html/cell-8-output-1.svg){}\n:::\n:::\n\n\nWe can see that at each point in the viewing window the tangent line exists due to the smoothness of the curve. Moreover, at a point $(x,y)$ the tangent will have slope $dy/dx$ satisfying:\n\n\n\n$$\n2xy + x^2 \\frac{dy}{dx} + a\\cdot b \\frac{dy}{dx} - a^2 = 0.\n$$\n\n\nSolving, yields:\n\n\n\n$$\n\\frac{dy}{dx} = \\frac{a^2 - 2xy}{ab + x^2}.\n$$\n\n\nIn particular, the point $(0,0)$ is always on this graph, and the tangent line will have positive slope $a^2/(ab) = a/b$.\n\n\n---\n\nThe [eight](http://www-history.mcs.st-and.ac.uk/Curves/Eight.html) curve has representation\n\n\n\n$$\nx^4 = a^2(x^2-y^2), \\quad a \\neq 0.\n$$\n\n\nA graph for $a=3$ shows why it has the name it does:\n\n::: {.cell hold='true' execution_count=8}\n``` {.julia .cell-code}\na = 3\nf(x,y) = x^4 - a^2*(x^2 - y^2)\nimplicit_plot(f)\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n![](implicit_differentiation_files/figure-html/cell-9-output-1.svg){}\n:::\n:::\n\n\nThe tangent line at $(x,y)$ will have slope, $dy/dx$ satisfying:\n\n\n\n$$\n4x^3 = a^2 \\cdot (2x - 2y \\frac{dy}{dx}).\n$$\n\n\nSolving gives:\n\n\n\n$$\n\\frac{dy}{dx} = -\\frac{4x^3 - a^2 \\cdot 2x}{a^2 \\cdot 2y}.\n$$\n\n\nThe point $(3,0)$ can be seen to be a solution to the equation and should have a vertical tangent line. This also is reflected in the formula, as the denominator is $a^2\\cdot 2 y$, which is $0$ at this point, whereas the numerator is not.\n\n\n##### Example\n\n\nThe quotient rule can be hard to remember, unlike the product rule. No reason to despair, the product rule plus implicit differentiation can be used to recover the quotient rule. Suppose $y=f(x)/g(x)$, then we could also write $y g(x) = f(x)$. Differentiating implicitly gives:\n\n\n\n$$\n\\frac{dy}{dx} g(x) + y g'(x) = f'(x).\n$$\n\n\nSolving for $dy/dx$ gives:\n\n\n\n$$\n\\frac{dy}{dx} = \\frac{f'(x) - y g'(x)}{g(x)}.\n$$\n\n\nNot quite what we expect, perhaps, but substituting in $f(x)/g(x)$ for $y$ gives us the usual formula:\n\n\n\n$$\n\\frac{dy}{dx} = \\frac{f'(x) - \\frac{f(x)}{g(x)} g'(x)}{g(x)} = \\frac{f'(x) g(x) - f(x) g'(x)}{g(x)^2}.\n$$\n\n\n:::{.callout-note}\n## Note\nIn this example we mix notations using $g'(x)$ to represent a derivative of $g$ with respect to $x$ and $dy/dx$ to represent the derivative of $y$ with respect to $x$. This is done to emphasize the value that we are solving for. It is just a convention though, we could just as well have used the \"prime\" notation for each.\n\n:::\n\n##### Example: Graphing a tangent line\n\n\nLet's see how to add a graph of a tangent line to the graph of an equation. Tangent lines are tangent at a point, so we need a point to discuss.\n\n\nReturning to the equation for a circle, $x^2 + y^2 = 1$, let's look at $(\\sqrt{2}/2, - \\sqrt{2}/2)$. The derivative is $-y/x$, so the slope at this point is $1$. The line itself has equation $y = b + m \\cdot (x-a)$. The following represents this in `Julia`:\n\n::: {.cell hold='true' execution_count=9}\n``` {.julia .cell-code}\nF(x,y) = x^2 + y^2 - 1\n\na,b = sqrt(2)/2, -sqrt(2)/2\n\nm = -a/b\ntl(x) = b + m * (x-a)\n\nimplicit_plot(F, xlims=(-2, 2), ylims=(-2, 2), aspect_ratio=:equal)\nplot!(tl)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n![](implicit_differentiation_files/figure-html/cell-10-output-1.svg){}\n:::\n:::\n\n\nWe added *both* the implicit plot of $F$ and the tangent line to the graph at the given point.\n\n\n##### Example\n\n\nWhen we assume $y$ is a function of $x$, it may not be feasible to actually find the function algebraically. However, in many cases one can be found numerically. Suppose $G(x,y) = c$ describes the equation. Then for a fixed $x$, $y(x)$ solves $G(x,y(x))) - c = 0$, so $y(x)$ is a zero of a known function. As long as we can piece together which $y$ goes with which, we can find the function.\n\n\nFor example, the [folium](http://www-history.mcs.st-and.ac.uk/Curves/Foliumd.html) of Descartes has the equation\n\n\n\n$$\nx^3 + y^3  = 3axy.\n$$\n\n\nSetting $a=1$ we have the graph:\n\n::: {.cell execution_count=10}\n``` {.julia .cell-code}\nùíÇ = 1\nG(x,y) = x^3 + y^3 - 3*ùíÇ*x*y\nimplicit_plot(G)\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n![](implicit_differentiation_files/figure-html/cell-11-output-1.svg){}\n:::\n:::\n\n\nWe can solve for the lower curve, $y$, as a function of $x$, as follows:\n\n::: {.cell execution_count=11}\n``` {.julia .cell-code}\ny1(x) = minimum(find_zeros(y->G(x,y), -10, 10))  # find_zeros from `Roots`\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```\ny1 (generic function with 1 method)\n```\n:::\n:::\n\n\nThis gives the lower part of the curve, which we can plot with:\n\n::: {.cell execution_count=12}\n``` {.julia .cell-code}\nplot(y1, -5, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n![](implicit_differentiation_files/figure-html/cell-13-output-1.svg){}\n:::\n:::\n\n\nThough, in this case, the cubic equation would admit a closed-form solution, the approach illustrated applies more generally.\n\n\n## Using SymPy for computation\n\n\n`SymPy` can be used to perform implicit differentiation. The three steps are similar: we assume $y$ is a function of $x$, *locally*; differentiate both sides; solve the result for $dy/dx$.\n\n\nLet's do so for the [Trident of Newton](http://www-history.mcs.st-and.ac.uk/Curves/Trident.html), which is represented in Cartesian form as follows:\n\n\n\n$$\nxy = cx^3 + dx^2 + ex + h.\n$$\n\n\nTo approach this task in `SymPy`, we begin by defining our symbolic expression. For now, we keep the parameters as symbolic values:\n\n::: {.cell execution_count=13}\n``` {.julia .cell-code}\n@syms a b c d x y\nex = x*y - (a*c^3 + b*x^2 + c*x + d)\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n- a c^{3} - b x^{2} - c x - d + x y\n\\]\n</span>\n```\n:::\n:::\n\n\nTo express that `y` is a locally a function of `x`, we use a \"symbolic function\" object:\n\n::: {.cell execution_count=14}\n``` {.julia .cell-code}\n@syms u()\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\n(u,)\n```\n:::\n:::\n\n\nThe object `u` is the symbolic function, and `u(x)` a symbolic expression involving a symbolic function.  This is what we will use to refer to `y`.\n\n\nAssume $y$ is a function of $x$, called `u(x)`, this substitution is just a renaming:\n\n::: {.cell execution_count=15}\n``` {.julia .cell-code}\nex1 = ex(y => u(x))\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n- a c^{3} - b x^{2} - c x - d + x u{\\left(x \\right)}\n\\]\n</span>\n```\n:::\n:::\n\n\nAt this point,  we differentiate in `x`:\n\n::: {.cell execution_count=16}\n``` {.julia .cell-code}\nex2 = diff(ex1, x)\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n- 2 b x - c + x \\frac{d}{d x} u{\\left(x \\right)} + u{\\left(x \\right)}\n\\]\n</span>\n```\n:::\n:::\n\n\nThe next step is solve for $dy/dx$ - the lone answer to the linear equation - which is done as follows:\n\n::: {.cell execution_count=17}\n``` {.julia .cell-code}\ndydx = diff(u(x), x)\nex3 = solve(ex2, dydx)[1]    # pull out lone answer with [1] indexing\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n\\frac{2 b x + c - u{\\left(x \\right)}}{x}\n\\]\n</span>\n```\n:::\n:::\n\n\nAs this represents an answer in terms of `u(x)`, we replace that term with the original variable:\n\n::: {.cell execution_count=18}\n``` {.julia .cell-code}\ndydx‚ÇÅ = ex3(u(x) => y)\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n\\frac{2 b x + c - y}{x}\n\\]\n</span>\n```\n:::\n:::\n\n\nIf `x` and `y` are the variable names, this function will combine the steps above:\n\n::: {.cell execution_count=19}\n``` {.julia .cell-code}\nfunction dy_dx(eqn, x, y)\n  @syms u()\n  eqn1 = eqn(y => u(x))\n  eqn2 = solve(diff(eqn1, x), diff(u(x), x))[1]\n  eqn2(u(x) => y)\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\ndy_dx (generic function with 1 method)\n```\n:::\n:::\n\n\nLet $a = b = c = d = 1$, then $(1,4)$ is a point on the curve. We can draw a tangent line to this point with these commands:\n\n::: {.cell execution_count=20}\n``` {.julia .cell-code}\nH = ex(a=>1, b=>1, c=>1, d=>1)\nx0, y0 = 1, 4\nùíé = dydx‚ÇÅ(x=>1, y=>4, a=>1, b=>1, c=>1, d=>1)\nimplicit_plot(lambdify(H); xlims=(-5,5), ylims=(-5,5), legend=false)\nplot!(y0 + ùíé * (x-x0))\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n![](implicit_differentiation_files/figure-html/cell-21-output-1.svg){}\n:::\n:::\n\n\nBasically this includes all the same steps as if done \"by hand.\" Some effort could have been saved in plotting, had values for the parameters been substituted initially, but not doing so shows their dependence in the derivative.\n\n\n:::{.callout-warning}\n## Warning\nThe use of `lambdify(H)` is needed to turn the symbolic expression, `H`, into a function.\n\n:::\n\n:::{.callout-note}\n## Note\nWhile `SymPy` itself has the `plot_implicit` function for plotting implicit equations,  this works only with `PyPlot`, not `Plots`, so we use the `ImplicitPlots` package in these examples.\n\n:::\n\n## Higher order derivatives\n\n\nImplicit differentiation can be used to find $d^2y/dx^2$ or other higher-order derivatives. At each stage, the same technique is applied. The only \"trick\" is that some simplifications can be made.\n\n\nFor example, consider $x^3 - y^3=3$. To find $d^2y/dx^2$, we first find $dy/dx$:\n\n\n\n$$\n3x^2 - (3y^2 \\frac{dy}{dx}) = 0.\n$$\n\n\nWe could solve for $dy/dx$ at this point - it always appears as a linear factor - to get:\n\n\n\n$$\n\\frac{dy}{dx} = \\frac{3x^2}{3y^2} = \\frac{x^2}{y^2}.\n$$\n\n\nHowever, we differentiate the first equation, as we generally try to avoid the quotient rule\n\n\n\n$$\n6x - (6y \\frac{dy}{dx} \\cdot \\frac{dy}{dx} + 3y^2 \\frac{d^2y}{dx^2}) = 0.\n$$\n\n\nAgain, if must be that $d^2y/dx^2$ appears as a linear factor, so we can solve for it:\n\n\n\n$$\n\\frac{d^2y}{dx^2} = \\frac{6x - 6y (\\frac{dy}{dx})^2}{3y^2}.\n$$\n\n\nOne last substitution for $dy/dx$ gives:\n\n\n\n$$\n\\frac{d^2y}{dx^2} = \\frac{-6x + 6y (\\frac{x^2}{y^2})^2}{3y^2} = -2\\frac{x}{y^2} + 2\\frac{x^4}{y^5} = 2\\frac{x}{y^2}(1 - \\frac{x^3}{y^3}) = 2\\frac{x}{y^5}(y^3 - x^3) = 2 \\frac{x}{y^5}(-3).\n$$\n\n\nIt isn't so pretty, but that's all it takes.\n\n\nTo visualize, we plot implicitly and notice that:\n\n\n  * as we change quadrants from the third to the fourth to the first the concavity changes from down to up to down, as the sign of the second derivative changes from negative to positive to negative;\n  * and that at these inflection points, the \"tangent\" line is vertical when $y=0$ and flat when $x=0$.\n\n::: {.cell execution_count=21}\n``` {.julia .cell-code}\nK(x,y) = x^3 - y^3 - 3\nimplicit_plot(K,  xlims=(-3, 3), ylims=(-3, 3))\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n![](implicit_differentiation_files/figure-html/cell-22-output-1.svg){}\n:::\n:::\n\n\nThe same problem can be done symbolically. The steps are similar, though the last step (replacing $x^3 - y^3$ with $3$) isn't done without explicitly asking.\n\n::: {.cell hold='true' execution_count=22}\n``` {.julia .cell-code}\n@syms x y u()\n\neqn    = K(x,y) - 3\neqn1   = eqn(y => u(x))\ndydx   = solve(diff(eqn1,x), diff(u(x), x))[1]        # 1 solution\nd2ydx2 = solve(diff(eqn1, x, 2), diff(u(x),x, 2))[1]  # 1 solution\neqn2   = d2ydx2(diff(u(x), x) => dydx, u(x) => y)\nsimplify(eqn2)\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n\\frac{2 x \\left(- x^{3} + y^{3}\\right)}{y^{5}}\n\\]\n</span>\n```\n:::\n:::\n\n\n## Inverse functions\n\n\nAs [mentioned](../precalc/inversefunctions.html), an [inverse](http://en.wikipedia.org/wiki/Inverse_function) function for $f(x)$ is a function $g(x)$ satisfying: $y = f(x)$ if and only if $g(y) = x$ for all $x$ in the domain of $f$ and $y$ in the range of $f$.\n\n\nIn short, both $f \\circ g$ and $g \\circ f$ are identify functions on their respective domains. As inverses are unique, their notation, $f^{-1}(x)$, reflects the name of the related function.\n\n\nThe chain rule can be used to give the derivative of an inverse function when applied to $f(f^{-1}(x)) = x$. Solving gives, $[f^{-1}(x)]' = 1 / f'(f^{-1}(x))$.\n\n\nThis is great - if we can remember the rules. If not, sometimes implicit differentiation can also help.\n\n\nConsider the inverse function for the tangent, which exists when the domain of the tangent function is restricted to $(-\\pi/2, \\pi/2)$. The function solves $y = \\tan^{-1}(x)$ or $\\tan(y) = x$. Differentiating this yields:\n\n\n\n$$\n\\sec(y)^2 \\frac{dy}{dx} = 1.\n$$\n\n\nOr $dy/dx = 1/\\sec^2(y)$.\n\n\nBut $\\sec(y)^2 = 1 + \\tan(y)^2 = 1 + x^2$, as can be seen by right-triangle trigonometry. This yields the formula $dy/dx = [\\tan^{-1}(x)]' = 1 / (1 + x^2)$.\n\n\n##### Example\n\n\nFor a more complicated example, suppose we have a moving trajectory $(x(t), y(t))$. The angle it makes with the origin satisfies\n\n\n\n$$\n\\tan(\\theta(t)) = \\frac{y(t)}{x(t)}.\n$$\n\n\nSuppose $\\theta(t)$ can be defined in terms of the inverse to some function ($\\tan^{-1}(x)$). We can differentiate implicitly to find $\\theta'(t)$ in terms of derivatives of $y$ and $x$:\n\n\n\n$$\n\\sec^2(\\theta(t)) \\cdot \\theta'(t) = \\frac{y'(t) x(t) - y(t) x'(t)}{x(t))^2}.\n$$\n\n\nBut $\\sec^2(\\theta(t)) = (r(t)/x(t))^2 = (x(t)^2 + y(t)^2) / x(t)^2$, so moving to the other side the secant term gives an explicit, albeit complicated, expression for the derivative of $\\theta$ in terms of the functions $x$ and $y$:\n\n\n\n$$\n\\theta'(t) = \\frac{x^2}{x^2(t) + y^2(t)} \\cdot \\frac{y'(t) x(t) - y(t) x'(t)}{x(t))^2} = \\frac{y'(t) x(t) - y(t) x'(t)}{x^2(t) + y^2(t)}.\n$$\n\n\nThis could have been made easier, had we leveraged the result of the previous example.\n\n\n#### Example: from physics\n\n\nMany problems are best done with implicit derivatives. A video showing such a problem along with how to do it analytically is [here](http://ocw.mit.edu/courses/mathematics/18-01sc-single-variable-calculus-fall-2010/unit-2-applications-of-differentiation/part-b-optimization-related-rates-and-newtons-method/session-32-ring-on-a-string/).\n\n\nThis video starts with a simple question:\n\n\n> If you have a rope and heavy ring, where will the ring position itself due to gravity?\n\n\n\nWell, suppose you hold the rope in two places, which we can take to be $(0,0)$ and $(a,b)$. Then let $(x,y)$ be all the possible positions of the ring that hold the rope taught. Then we have this picture:\n\n::: {.cell hold='true' execution_count=23}\n\n::: {.cell-output .cell-output-display execution_count=24}\n![](implicit_differentiation_files/figure-html/cell-24-output-1.svg){}\n:::\n:::\n\n\nSince the length of the rope does not change, we must have for any admissible $(x,y)$ that:\n\n\n\n$$\nL = \\sqrt{x^2 + y^2} + \\sqrt{(a-x)^2 + (b-y)^2},\n$$\n\n\nwhere these terms come from  the two hypotenuses in the figure, as computed through Pythagorean's theorem.\n\n\n> If we assume that the ring will minimize the value of y subject to this constraint, can we solve for y?\n\n\n\nWe create a function to represent the equation:\n\n::: {.cell execution_count=24}\n``` {.julia .cell-code}\nF‚ÇÄ(x, y, a, b) = sqrt(x^2 + y^2) + sqrt((a-x)^2 + (b-y)^2)\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```\nF‚ÇÄ (generic function with 1 method)\n```\n:::\n:::\n\n\nTo illustrate, we need specific values of $a$, $b$, and $L$:\n\n::: {.cell execution_count=25}\n``` {.julia .cell-code}\nùêö, ùêõ, ùêã = 3, 3, 10      # L > sqrt{a^2 + b^2}\nF‚ÇÄ(x, y) = F‚ÇÄ(x, y, ùêö, ùêõ)\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```\nF‚ÇÄ (generic function with 2 methods)\n```\n:::\n:::\n\n\nOur values $(x,y)$ must satisfy $f(x,y) = L$. Let's graph:\n\n::: {.cell execution_count=26}\n``` {.julia .cell-code}\nimplicit_plot((x,y) -> F‚ÇÄ(x,y) - ùêã, xlims=(-5, 7), ylims=(-5, 7))\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n![](implicit_differentiation_files/figure-html/cell-27-output-1.svg){}\n:::\n:::\n\n\nThe graph is an ellipse, though slightly tilted.\n\n\nOkay, now to find the lowest point. This will be when the derivative is $0$. We solve by assuming $y$ is a function of $x$ called `u`. We have already defined symbolic variables `a`, `b`, `x`, and `y`, here we define `L`:\n\n::: {.cell execution_count=27}\n``` {.julia .cell-code}\n@syms L\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```\n(L,)\n```\n:::\n:::\n\n\nThen\n\n::: {.cell execution_count=28}\n``` {.julia .cell-code}\neqn = F‚ÇÄ(x,y,a,b) - L\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n- L + \\sqrt{x^{2} + y^{2}} + \\sqrt{\\left(0.05 - x\\right)^{2} + \\left(0.25 - y\\right)^{2}}\n\\]\n</span>\n```\n:::\n:::\n\n\n::: {.cell execution_count=29}\n``` {.julia .cell-code}\neqn_1 = diff(eqn(y => u(x)), x)\neqn_2 = solve(eqn_1, diff(u(x), x))[1]\ndydx‚ÇÇ  = eqn_2(u(x) => y)\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n\\frac{- 20.0 x \\sqrt{x^{2} + y^{2}} - 20.0 x \\sqrt{\\left(x - 0.05\\right)^{2} + \\left(y - 0.25\\right)^{2}} + \\sqrt{x^{2} + y^{2}}}{20.0 y \\left(x^{2} + y^{2}\\right)^{0.5} + 20.0 y \\left(\\left(x - 0.05\\right)^{2} + \\left(y - 0.25\\right)^{2}\\right)^{0.5} - 5.0 \\left(x^{2} + y^{2}\\right)^{0.5}}\n\\]\n</span>\n```\n:::\n:::\n\n\nWe are looking for when the tangent line has $0$ slope, or when `dydx` is $0$:\n\n::: {.cell execution_count=30}\n``` {.julia .cell-code}\ncps = solve(dydx‚ÇÇ, x)\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```\n2-element Vector{Sym}:\n               0.2‚ãÖy\n 0.2*y/(8.0*y - 1.0)\n```\n:::\n:::\n\n\nThere are two answers, as we could guess from the graph, but we want the one for the smallest value of $y$, which is the second.\n\n\nThe values of `dydx` depend on any pair $(x,y)$, but our solution must also satisfy the equation. That is for our value of $x$, we need to find the corresponding $y$. This should be possible by substituting:\n\n::: {.cell execution_count=31}\n``` {.julia .cell-code}\neqn1 = eqn(x => cps[2])\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n- L + \\sqrt{y^{2} + \\frac{0.000625 y^{2}}{\\left(y - 0.125\\right)^{2}}} + \\sqrt{\\left(0.25 - y\\right)^{2} + 0.04 \\left(- \\frac{y}{8.0 y - 1.0} + 0.25\\right)^{2}}\n\\]\n</span>\n```\n:::\n:::\n\n\nWe would try to solve `eqn1` for `y` with `solve(eqn1, y)`, but `SymPy` can't complete this problem. Instead, we will approach this numerically using `find_zero` from the `Roots` package. We make the above a function of `y` alone\n\n::: {.cell execution_count=32}\n``` {.julia .cell-code}\neqn2 = eqn1(a=>3, b=>3, L=>10)\nystar = find_zero(eqn2, -3)\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```\n-3.4872035192968935\n```\n:::\n:::\n\n\nOkay, now we need to put this value back into our expression for the `x` value and also substitute in for the parameters:\n\n::: {.cell execution_count=33}\n``` {.julia .cell-code}\nxstar = N(cps[2](y => ystar, a =>3, b => 3, L => 3))\n```\n\n::: {.cell-output .cell-output-display execution_count=34}\n```\n0.024134877095571772\n```\n:::\n:::\n\n\nOur minimum is at `(xstar, ystar)`, as this graphic shows:\n\n::: {.cell execution_count=34}\n``` {.julia .cell-code}\ntl(x) = ystar + 0 * (x- xstar)\nimplicit_plot((x,y) -> F‚ÇÄ(x,y,3,3) - 10, xlims=(-4, 7), ylims=(-10, 10))\nplot!(tl)\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n![](implicit_differentiation_files/figure-html/cell-35-output-1.svg){}\n:::\n:::\n\n\nIf you watch the video linked to above, you will see that the surprising fact here is the resting point is such that the angles formed by the rope are the same. Basically this makes the tension in both parts of the rope equal, so there is a static position (if not static, the ring would move and not end in the final position). We can verify this fact numerically by showing the arctangents of the two triangles are the same up to a sign:\n\n::: {.cell execution_count=35}\n``` {.julia .cell-code}\na0, b0 = 0,0   # the foci of the ellipse are (0,0) and (3,3)\na1, b1 = 3, 3\natan((b0 - ystar)/(a0 - xstar)) + atan((b1 - ystar)/(a1 - xstar)) # ‚âà 0\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```\n-0.42316792063329345\n```\n:::\n:::\n\n\nNow, were we lucky and just happened to take $a=3$, $b = 3$ in such a way to make this work? Well, no. But convince yourself by doing the above for different values of $b$.\n\n---\n\n\nIn the above, we started with $F(x,y) = L$ and solved symbolically for $y=f(x)$ so that $F(x,f(x)) = L$. Then we took a derivative of $f(x)$ and set this equal to $0$ to solve for the minimum $y$ values.\n\n\nHere we try the same problem numerically, using a zero-finding approach to identify $f(x))$.\n\n\nStarting with $F(x,y) = \\sqrt{x^2 + y^2} + \\sqrt{(x-1)^2 + (b-2)^2}$ and $L=3$, we have:\n\n::: {.cell execution_count=36}\n``` {.julia .cell-code}\nF‚ÇÅ(x,y) = F‚ÇÄ(x,y, 1, 2) - 3 # a,b,L = 1,2,3\nimplicit_plot(F‚ÇÅ)\n```\n\n::: {.cell-output .cell-output-display execution_count=37}\n![](implicit_differentiation_files/figure-html/cell-37-output-1.svg){}\n:::\n:::\n\n\nTrying to find the lowest $y$ value we have from the graph it is near $x=0.1$. We can do better.\n\n\nFirst, we could try so solve for the $f$ using `find_zero`. Here is one way:\n\n::: {.cell execution_count=37}\n``` {.julia .cell-code}\nf‚ÇÄ(x) = find_zero(y -> F‚ÇÅ(x, y), 0)\n```\n\n::: {.cell-output .cell-output-display execution_count=38}\n```\nf‚ÇÄ (generic function with 1 method)\n```\n:::\n:::\n\n\nWe use $0$ as an initial guess, as the $y$ value is near $0$. More on this later. We could then just sample many $x$ values between $-0.5$ and $1.5$ and find the one corresponding to the smallest $t$ value:\n\n::: {.cell execution_count=38}\n``` {.julia .cell-code}\nfindmin([f‚ÇÄ(x) for x ‚àà range(-0.5, 1.5, length=100)])\n```\n\n::: {.cell-output .cell-output-display execution_count=39}\n```\n(-0.4142135621686101, 33)\n```\n:::\n:::\n\n\nThis shows the smallest value is around $-0.414$ and occurs in the $33$rd position of the sampled $x$ values. Pretty good, but we can do better. We just need to differentiate $f$, solve for $f'(x) = 0$ and then put that value back into $f$ to find the smallest $y$.\n\n\n**However** there is one subtle point. Using automatic differentiation, as implemented in `ForwardDiff`, with `find_zero` requires the `x0` initial value to have a certain type. In this case, the same type as the \"`x`\" passed into $f(x)$. So rather than use an initial value of $0$, we must use an initial value `zero(x)`! (Otherwise, there will be an error \"`no method matching Float64(::ForwardDiff.Dual{...`\".)\n\n\nWith this slight modification, we have:\n\n::: {.cell execution_count=39}\n``` {.julia .cell-code}\nf‚ÇÅ(x) = find_zero(y -> F‚ÇÅ(x, y), zero(x))\nplot(f‚ÇÅ', -0.5, 1.5)\n```\n\n::: {.cell-output .cell-output-display execution_count=40}\n![](implicit_differentiation_files/figure-html/cell-40-output-1.svg){}\n:::\n:::\n\n\nThe zero of `f'` is a bit to the right of $0$, say $0.2$; we use `find_zero` again to find it:\n\n::: {.cell execution_count=40}\n``` {.julia .cell-code}\nxstar‚ÇÅ = find_zero(f‚ÇÅ', 0.2)\nxstar‚ÇÅ, f‚ÇÅ(xstar‚ÇÅ)\n```\n\n::: {.cell-output .cell-output-display execution_count=41}\n```\n(0.146446609406726, -0.4142135623730952)\n```\n:::\n:::\n\n\nIt is important to note that the above uses of `find_zero` required *good* initial guesses, which we were fortunate enough to identify.\n\n\n## Questions\n\n\n###### Question\n\n\nIs $(1,1)$ on the graph of\n\n\n\n$$\nx^2 - 2xy + y^2 = 1?\n$$\n\n::: {.cell hold='true' execution_count=41}\n\n::: {.cell-output .cell-output-display execution_count=42}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='Xwmc52qv' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_Xwmc52qv\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_Xwmc52qv\"\n              id=\"radio_Xwmc52qv_1\" value=\"1\">\n      <span class=\"label-body\">\n        Yes\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_Xwmc52qv\"\n              id=\"radio_Xwmc52qv_2\" value=\"2\">\n      <span class=\"label-body\">\n        No\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='Xwmc52qv_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_Xwmc52qv\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('Xwmc52qv_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_Xwmc52qv\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_Xwmc52qv\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nFor the equation\n\n\n\n$$\nx^2y + 2y - 4 x = 0,\n$$\n\n\nif $x=4$, what is a value for $y$ such that $(x,y)$ is a point on the graph of the equation?\n\n::: {.cell hold='true' execution_count=42}\n\n::: {.cell-output .cell-output-display execution_count=43}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='NLEssX8r' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_NLEssX8r\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"row\">\n  <span style=\"width:90%\">\n    <input id=\"NLEssX8r\" type=\"number\" class=\"form-control\" placeholder=\"Numeric answer\">\n  </span>\n  <span style=\"width:10%\">\n  </span>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='NLEssX8r_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.getElementById(\"NLEssX8r\").addEventListener(\"change\", function() {\n  var correct = (Math.abs(this.value - 0.8888888888888888) <= 0.001);\n  var msgBox = document.getElementById('NLEssX8r_message');\n    if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_NLEssX8r\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_NLEssX8r\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nFor the equation\n\n\n\n$$\n(y-5)\\cdot \\cos(4\\cdot \\sqrt{(x-4)^2 + y^2)} =  x\\cdot\\sin(2\\sqrt{x^2 + y^2})\n$$\n\n\nis the point $(5,0)$ a solution?\n\n::: {.cell hold='true' execution_count=43}\n\n::: {.cell-output .cell-output-display execution_count=44}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='Gk8s23k6' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_Gk8s23k6\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_Gk8s23k6\"\n              id=\"radio_Gk8s23k6_1\" value=\"1\">\n      <span class=\"label-body\">\n        Yes\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_Gk8s23k6\"\n              id=\"radio_Gk8s23k6_2\" value=\"2\">\n      <span class=\"label-body\">\n        No\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='Gk8s23k6_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_Gk8s23k6\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('Gk8s23k6_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_Gk8s23k6\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_Gk8s23k6\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n##### Question\n\n\nLet $(x/3)^2 + (y/2)^2 = 1$. Find the slope of the tangent line at the point $(3/\\sqrt{2}, 2/\\sqrt{2})$.\n\n::: {.cell hold='true' execution_count=44}\n\n::: {.cell-output .cell-output-display execution_count=45}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='ix8UKfCZ' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_ix8UKfCZ\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"row\">\n  <span style=\"width:90%\">\n    <input id=\"ix8UKfCZ\" type=\"number\" class=\"form-control\" placeholder=\"Numeric answer\">\n  </span>\n  <span style=\"width:10%\">\n  </span>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='ix8UKfCZ_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.getElementById(\"ix8UKfCZ\").addEventListener(\"change\", function() {\n  var correct = (Math.abs(this.value - -0.6666666666666666) <= 0.001);\n  var msgBox = document.getElementById('ix8UKfCZ_message');\n    if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_ix8UKfCZ\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_ix8UKfCZ\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe [lame](http://www-history.mcs.st-and.ac.uk/Curves/Lame.html) curves satisfy:\n\n\n\n$$\n\\left(\\frac{x}{a}\\right)^n + \\left(\\frac{y}{b}\\right)^n = 1.\n$$\n\n\nAn ellipse is when $n=1$. Take $n=3$, $a=1$, and $b=2$.\n\n\nFind a *positive* value of $y$ when $x=1/2$.\n\n::: {.cell hold='true' execution_count=45}\n\n::: {.cell-output .cell-output-display execution_count=46}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='qibobfEx' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_qibobfEx\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"row\">\n  <span style=\"width:90%\">\n    <input id=\"qibobfEx\" type=\"number\" class=\"form-control\" placeholder=\"Numeric answer\">\n  </span>\n  <span style=\"width:10%\">\n  </span>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='qibobfEx_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.getElementById(\"qibobfEx\").addEventListener(\"change\", function() {\n  var correct = (Math.abs(this.value - 1.9129311827723892) <= 0.001);\n  var msgBox = document.getElementById('qibobfEx_message');\n    if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_qibobfEx\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_qibobfEx\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n});\n\n</script>\n```\n:::\n:::\n\n\nWhat expression gives $dy/dx$?\n\n::: {.cell hold='true' execution_count=46}\n\n::: {.cell-output .cell-output-display execution_count=47}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='ukBB6Frq' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_ukBB6Frq\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_ukBB6Frq\"\n              id=\"radio_ukBB6Frq_1\" value=\"1\">\n      <span class=\"label-body\">\n        \\(-(x/a)^n / (y/b)^n\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_ukBB6Frq\"\n              id=\"radio_ukBB6Frq_2\" value=\"2\">\n      <span class=\"label-body\">\n        \\(b \\cdot (1 - (x/a)^n)^{1/n}\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_ukBB6Frq\"\n              id=\"radio_ukBB6Frq_3\" value=\"3\">\n      <span class=\"label-body\">\n        \\(-(y/x) \\cdot (x/a)^n \\cdot (y/b)^{-n}\\)\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='ukBB6Frq_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_ukBB6Frq\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 3;\n    var msgBox = document.getElementById('ukBB6Frq_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_ukBB6Frq\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_ukBB6Frq\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nLet $y - x^2 = -\\log(x)$. At the point $(1/2, 0.9431...)$, the graph has a tangent line. Find this line, then find its intersection point with the $y$ axes.\n\n\nThis intersection is:\n\n::: {.cell hold='true' execution_count=47}\n\n::: {.cell-output .cell-output-display execution_count=48}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='jPlb4Yf2' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_jPlb4Yf2\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"row\">\n  <span style=\"width:90%\">\n    <input id=\"jPlb4Yf2\" type=\"number\" class=\"form-control\" placeholder=\"Numeric answer\">\n  </span>\n  <span style=\"width:10%\">\n  </span>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='jPlb4Yf2_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.getElementById(\"jPlb4Yf2\").addEventListener(\"change\", function() {\n  var correct = (Math.abs(this.value - 1.4431471805599454) <= 0.001);\n  var msgBox = document.getElementById('jPlb4Yf2_message');\n    if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_jPlb4Yf2\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_jPlb4Yf2\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe [witch](http://www-history.mcs.st-and.ac.uk/Curves/Witch.html) of [Agnesi](http://www.maa.org/publications/periodicals/convergence/mathematical-treasures-maria-agnesis-analytical-institutions) is the curve given by the equation\n\n\n\n$$\ny(x^2 + a^2) = a^3.\n$$\n\n\nIf $a=1$, numerically find a a value of $y$ when $x=2$.\n\n::: {.cell hold='true' execution_count=48}\n\n::: {.cell-output .cell-output-display execution_count=49}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='1msrDc5c' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_1msrDc5c\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"row\">\n  <span style=\"width:90%\">\n    <input id=\"1msrDc5c\" type=\"number\" class=\"form-control\" placeholder=\"Numeric answer\">\n  </span>\n  <span style=\"width:10%\">\n  </span>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='1msrDc5c_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.getElementById(\"1msrDc5c\").addEventListener(\"change\", function() {\n  var correct = (Math.abs(this.value - 0.20000000000000004) <= 0.001);\n  var msgBox = document.getElementById('1msrDc5c_message');\n    if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_1msrDc5c\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_1msrDc5c\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n});\n\n</script>\n```\n:::\n:::\n\n\nWhat expression yields $dy/dx$ for this curve:\n\n::: {.cell hold='true' execution_count=49}\n\n::: {.cell-output .cell-output-display execution_count=50}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='PSBKTWvT' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_PSBKTWvT\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_PSBKTWvT\"\n              id=\"radio_PSBKTWvT_1\" value=\"1\">\n      <span class=\"label-body\">\n        \\(a^3/(x^2 + a^2)\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_PSBKTWvT\"\n              id=\"radio_PSBKTWvT_2\" value=\"2\">\n      <span class=\"label-body\">\n        \\(-2xy/(x^2 + a^2)\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_PSBKTWvT\"\n              id=\"radio_PSBKTWvT_3\" value=\"3\">\n      <span class=\"label-body\">\n        \\(2xy / (x^2 + a^2)\\)\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='PSBKTWvT_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_PSBKTWvT\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('PSBKTWvT_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_PSBKTWvT\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_PSBKTWvT\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n![Image number 35 from L'Hospitals calculus book (the first). Given a description of the curve, identify the point ``E`` which maximizes the height. ](../derivatives/figures/fcarc-may2016-fig35-350.gif)\n\n\n\nThe figure above shows a problem appearing in L'Hospital's first calculus book. Given a function defined implicitly by $x^3 + y^3 = axy$  (with $AP=x$, $AM=y$ and $AB=a$) find the point $E$ that maximizes the height. In the [AMS feature column](http://www.ams.org/samplings/feature-column/fc-2016-05) this problem is illustrated and solved in the historical manner, with the comment that the concept of implicit differentiation wouldn't have occurred to L'Hospital.\n\n\nUsing Implicit differentiation, find when $dy/dx = 0$.\n\n::: {.cell hold='true' execution_count=51}\n\n::: {.cell-output .cell-output-display execution_count=52}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='jg6rIYL7' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_jg6rIYL7\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_jg6rIYL7\"\n              id=\"radio_jg6rIYL7_1\" value=\"1\">\n      <span class=\"label-body\">\n        \\(y=3x^2/a\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_jg6rIYL7\"\n              id=\"radio_jg6rIYL7_2\" value=\"2\">\n      <span class=\"label-body\">\n        \\(y=a/(3x^2)\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_jg6rIYL7\"\n              id=\"radio_jg6rIYL7_3\" value=\"3\">\n      <span class=\"label-body\">\n        \\(y^2=a/(3x)\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_jg6rIYL7\"\n              id=\"radio_jg6rIYL7_4\" value=\"4\">\n      <span class=\"label-body\">\n        \\(y^2 = 3x/a\\)\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='jg6rIYL7_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_jg6rIYL7\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 1;\n    var msgBox = document.getElementById('jg6rIYL7_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_jg6rIYL7\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_jg6rIYL7\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\nSubstituting the correct value of $y$, above, into the defining equation gives what value for $x$:\n\n::: {.cell hold='true' execution_count=52}\n\n::: {.cell-output .cell-output-display execution_count=53}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='7hEmCen4' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_7hEmCen4\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_7hEmCen4\"\n              id=\"radio_7hEmCen4_1\" value=\"1\">\n      <span class=\"label-body\">\n        \\(x=(1/3) a 2^{1/3}\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_7hEmCen4\"\n              id=\"radio_7hEmCen4_2\" value=\"2\">\n      <span class=\"label-body\">\n        \\(x=(1/2) a^3 3^{1/3}\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_7hEmCen4\"\n              id=\"radio_7hEmCen4_3\" value=\"3\">\n      <span class=\"label-body\">\n        \\(x=(1/2) a 2^{1/2}\\)\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_7hEmCen4\"\n              id=\"radio_7hEmCen4_4\" value=\"4\">\n      <span class=\"label-body\">\n        \\(x=(1/3) a^2 2^{1/2}\\)\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='7hEmCen4_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_7hEmCen4\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 1;\n    var msgBox = document.getElementById('7hEmCen4_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_7hEmCen4\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_7hEmCen4\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nFor the equation of an ellipse:\n\n\n\n$$\n\\left(\\frac{x}{a}\\right)^2 + \\left(\\frac{y}{b}\\right)^2 = 1,\n$$\n\n\ncompute $d^2y/dx^2$. Is this the answer?\n\n\n\n$$\n\\frac{d^2y}{dx^2} = -\\frac{b^2}{a^2\\cdot y} - \\frac{b^4\\cdot x^2}{a^4\\cdot y^3} = -\\frac{1}{y}\\frac{b^2}{a^2}(1 + \\frac{b^2 x^2}{a^2 y^2}).\n$$\n\n::: {.cell hold='true' execution_count=53}\n\n::: {.cell-output .cell-output-display execution_count=54}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='PEPMJsaZ' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_PEPMJsaZ\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_PEPMJsaZ\"\n              id=\"radio_PEPMJsaZ_1\" value=\"1\">\n      <span class=\"label-body\">\n        Yes\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_PEPMJsaZ\"\n              id=\"radio_PEPMJsaZ_2\" value=\"2\">\n      <span class=\"label-body\">\n        No\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='PEPMJsaZ_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_PEPMJsaZ\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 1;\n    var msgBox = document.getElementById('PEPMJsaZ_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_PEPMJsaZ\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_PEPMJsaZ\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\nIf $y>0$ is the sign positive or negative?\n\n::: {.cell hold='true' execution_count=54}\n\n::: {.cell-output .cell-output-display execution_count=55}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='WusmCyDE' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_WusmCyDE\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_WusmCyDE\"\n              id=\"radio_WusmCyDE_1\" value=\"1\">\n      <span class=\"label-body\">\n        positive\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_WusmCyDE\"\n              id=\"radio_WusmCyDE_2\" value=\"2\">\n      <span class=\"label-body\">\n        negative\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_WusmCyDE\"\n              id=\"radio_WusmCyDE_3\" value=\"3\">\n      <span class=\"label-body\">\n        Can be both\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='WusmCyDE_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_WusmCyDE\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('WusmCyDE_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_WusmCyDE\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_WusmCyDE\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\nIf $x>0$ is the sign positive or negative?\n\n::: {.cell hold='true' execution_count=55}\n\n::: {.cell-output .cell-output-display execution_count=56}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='0lYFhAEm' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_0lYFhAEm\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_0lYFhAEm\"\n              id=\"radio_0lYFhAEm_1\" value=\"1\">\n      <span class=\"label-body\">\n        positive\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_0lYFhAEm\"\n              id=\"radio_0lYFhAEm_2\" value=\"2\">\n      <span class=\"label-body\">\n        negative\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_0lYFhAEm\"\n              id=\"radio_0lYFhAEm_3\" value=\"3\">\n      <span class=\"label-body\">\n        Can be both\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='0lYFhAEm_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_0lYFhAEm\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 3;\n    var msgBox = document.getElementById('0lYFhAEm_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_0lYFhAEm\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_0lYFhAEm\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\nWhen $x>0$, the graph of the equation is...\n\n::: {.cell hold='true' execution_count=56}\n\n::: {.cell-output .cell-output-display execution_count=57}\n```{=html}\n<form class=\"mx-2 my-3\" name='WeaveQuestion' data-id='2fttBEYz' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form-floating input-group\" id=\"controls_2fttBEYz\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_2fttBEYz\"\n              id=\"radio_2fttBEYz_1\" value=\"1\">\n      <span class=\"label-body\">\n        concave up\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_2fttBEYz\"\n              id=\"radio_2fttBEYz_2\" value=\"2\">\n      <span class=\"label-body\">\n        concave down\n      </span>\n    </input>\n  </label>\n</div>\n<div class=\"form-check\">\n  <label>\n    <input class=\"form-check-input\" type=\"radio\" name=\"radio_2fttBEYz\"\n              id=\"radio_2fttBEYz_3\" value=\"3\">\n      <span class=\"label-body\">\n        both concave up and down\n      </span>\n    </input>\n  </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='2fttBEYz_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_2fttBEYz\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 3;\n    var msgBox = document.getElementById('2fttBEYz_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_2fttBEYz\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_2fttBEYz\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n## Appendix\n\n\nThere are other packages in the `Julia` ecosystem that can plot implicit equations.\n\n\n### The ImplicitEquations package\n\n\nThe `ImplicitEquations` packages can plot equations and inequalities. The use is somewhat similar to the examples above, but the object plotted is a predicate, not a function. These predicates are created with functions like `Eq` or `Lt`.\n\n\nFor example, the `ImplicitPlots` manual shows this function $f(x,y) = (x^4 + y^4 - 1) \\cdot (x^2 + y^2 - 2) + x^5 \\cdot y$ to plot. Using `ImplicitEquations`, this equation would be plotted with:\n\n::: {.cell hold='true' execution_count=57}\n``` {.julia .cell-code}\nusing ImplicitEquations\nf(x,y) = (x^4 + y^4 - 1) * (x^2 + y^2 - 2) + x^5 * y\nr = Eq(f, 0)  # the equation f(x,y) = 0\nplot(r)\n```\n\n::: {.cell-output .cell-output-display execution_count=58}\n![](implicit_differentiation_files/figure-html/cell-58-output-1.svg){}\n:::\n:::\n\n\nUnlike `ImplicitPlots`, inequalities may be displayed:\n\n::: {.cell hold='true' execution_count=58}\n``` {.julia .cell-code}\nf(x,y) = (x^4 + y^4 - 1) * (x^2 + y^2 - 2) + x^5 * y\nr = Lt(f, 0)          # the inequality f(x,y) < 0\nplot(r; M=10, N=10)  # less blocky\n```\n\n::: {.cell-output .cell-output-display execution_count=59}\n![](implicit_differentiation_files/figure-html/cell-59-output-1.svg){}\n:::\n:::\n\n\nThe rendered plots look \"blocky\" due to the algorithm used to plot the equations. As there is no rule defining $(x,y)$ pairs to plot, a search by regions is done. A region is initially labeled undetermined. If it can be shown that for any value in the region the equation is true (equations can also be inequalities), the region is colored black. If it can be shown it will never be true, the region is dropped. If a black-and-white answer is not clear, the region is subdivided and each subregion is similarly tested. This continues until the remaining undecided regions are smaller than some threshold. Such regions comprise a boundary, and here are also colored black. Only regions are plotted - not $(x,y)$ pairs - so the results are blocky. Pass larger values of $N=M$ (with defaults of $8$) to `plot` to lower the threshold at the cost of longer computation times, as seen in the last example.\n\n\n### The IntervalConstraintProgramming package\n\n\nThe `IntervalConstraintProgramming` package also can be used to graph implicit equations. For certain problem descriptions it is significantly faster and makes better graphs. The usage is slightly more involved. We show the commands, but don't run them here, as there are minor conflicts with the `CalculusWithJulia`package.\n\n\nWe specify a problem using the `@constraint` macro. Using a macro allows expressions to involve free symbols, so the problem is specified in an equation-like manner:\n\n``` {.julia .cell-code}\nS = @constraint x^2 + y^2 <= 2\n```\n\n\nThe right hand side must be a number.\n\n\nThe area to plot over must be specified as an `IntervalBox`, basically a pair of intervals. The interval $[a,b]$ is expressed through `a..b`:\n\n``` {.julia .cell-code}\nJ = -3..3\nX = IntervalArithmetic.IntervalBox(J, J)\n```\n\n\nThe `pave` command does the heavy lifting:\n\n``` {.julia .cell-code}\nregion = IntervalConstraintProgramming.pave(S, X)\n```\n\n\nA plot can be made of either the boundary, the interior, or both.\n\n``` {.julia .cell-code}\nplot(region.inner)       # plot interior; use r.boundary for boundary\n```\n\n\n",
    "supporting": [
      "implicit_differentiation_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}