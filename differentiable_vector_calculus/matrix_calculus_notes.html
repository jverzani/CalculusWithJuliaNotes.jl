<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>60&nbsp; Matrix calculus – Calculus with Julia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../differentiable_vector_calculus/plots_plotting.html" rel="next">
<link href="../differentiable_vector_calculus/vector_fields.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-2b3e328b71be8d25427581baeb23079b.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-fc3c171632cd6f9b39f96e8bd14edcbe.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-ead2ac9af0e74c5b0758b4163d044a68.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-fc3c171632cd6f9b39f96e8bd14edcbe.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Calculus with Julia</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/tree/main/quarto/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../differentiable_vector_calculus.html">Differential vector calculus</a></li><li class="breadcrumb-item"><a href="../differentiable_vector_calculus/matrix_calculus_notes.html"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Matrix calculus</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mathematical basics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/calculator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">From calculator to computer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/numbers_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Number systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/logical_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inequalities, Logical expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors and containers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/ranges.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ranges and sets</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../precalc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Precalculus Concepts</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The graph of a function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Function manipulations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/inversefunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The inverse of a function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomial_roots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Roots of a polynomial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/polynomials_package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Polynomials package</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/rational_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rational functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/exp_log_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential and logarithmic functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/trig_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Trigonometric functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../precalc/julia_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Overview of Julia commands</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../limits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Limits</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Limits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/limits_extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Limits, issues, extensions of the concept</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/continuity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Continuity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../limits/intermediate_value_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Implications of continuity</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Derivatives</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/numeric_derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Numeric derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/symbolic_derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Symbolic derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/mean_value_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">The mean value theorem for differentiable functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/first_second_derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The first and second derivatives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/curve_sketching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Curve sketching</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/linearization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linearization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/newtons_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Newton’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/more_zeros.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Derivative-free alternatives to Newton’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/lhospitals_rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">L’Hospital’s rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/implicit_differentiation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Implicit differentiation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/related_rates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Related rates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../derivatives/taylor_series_polynomials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Taylor polynomials and other approximating polynomials</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integrals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Integrals</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Area under a curve</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/ftc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Fundamental Theorem of Calculus</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/substitution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Substitution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/integration_by_parts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Integration by parts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/partial_fractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Partial fractions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/improper_integrals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Improper integrals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/mean_value_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Mean value theorem for integrals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/area_between_curves.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Area between two curves</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/center_of_mass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Center of mass</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/volumes_slice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Volumes by slicing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/arc_length.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Arc length</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/surface_area.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Surface area</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/orthogonal_polynomials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Orthogonal polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integrals/twelve-qs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">A dozen minima for a parabola</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../ODEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ODEs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/odes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/euler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Euler’s method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/solve.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">The problem-algorithm-solve interface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ODEs/differential_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">The <code>DifferentialEquations</code> suite</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../differentiable_vector_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Differential vector calculus</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/polar_coordinates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Polar coordinates and curves</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Vectors and matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_valued_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Vector-valued functions, <span class="math inline">\(f:R \rightarrow R^n\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Scalar functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/scalar_functions_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Applications with scalar functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/vector_fields.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/matrix_calculus_notes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Matrix calculus</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../differentiable_vector_calculus/plots_plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../integral_vector_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Integral vector calculus</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/double_triple_integrals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Multi-dimensional integrals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/line_integrals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Line and surface integrals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/div_grad_curl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">The gradient, divergence, and curl</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/stokes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Green’s theorem, Stokes’ theorem, and the divergence theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../integral_vector_calculus/review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Quick review of vector calculus</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../alternatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alternative packages</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/symbolics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Symbolics.jl</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/SciML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">The SciML suite of packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/plotly_plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">JavaScript based plotting libraries</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../alternatives/makie_plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Calculus plots with Makie</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/getting_started_with_julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Getting started with Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/julia_interfaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Julia interfaces</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/calculus_with_julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">The <code>CalculusWithJulia</code> package</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/unicode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Usages of Unicode symbols</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/quick_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Quick introduction to Calculus with Julia</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#review" id="toc-review" class="nav-link active" data-scroll-target="#review"><span class="header-section-number">60.1</span> Review</a>
  <ul class="collapse">
  <li><a href="#univariate-vector-valued" id="toc-univariate-vector-valued" class="nav-link" data-scroll-target="#univariate-vector-valued"><span class="header-section-number">60.1.1</span> Univariate, vector-valued</a></li>
  <li><a href="#multivariate-scalar-valued" id="toc-multivariate-scalar-valued" class="nav-link" data-scroll-target="#multivariate-scalar-valued"><span class="header-section-number">60.1.2</span> Multivariate, scalar-valued</a></li>
  <li><a href="#multivariate-vector-valued" id="toc-multivariate-vector-valued" class="nav-link" data-scroll-target="#multivariate-vector-valued"><span class="header-section-number">60.1.3</span> Multivariate, vector-valued</a></li>
  <li><a href="#vector-spaces" id="toc-vector-spaces" class="nav-link" data-scroll-target="#vector-spaces"><span class="header-section-number">60.1.4</span> Vector spaces</a></li>
  <li><a href="#linear-operators" id="toc-linear-operators" class="nav-link" data-scroll-target="#linear-operators"><span class="header-section-number">60.1.5</span> Linear operators</a></li>
  </ul></li>
  <li><a href="#the-derivative-as-a-linear-operator" id="toc-the-derivative-as-a-linear-operator" class="nav-link" data-scroll-target="#the-derivative-as-a-linear-operator"><span class="header-section-number">60.2</span> The derivative as a linear operator</a></li>
  <li><a href="#differentation-rules" id="toc-differentation-rules" class="nav-link" data-scroll-target="#differentation-rules"><span class="header-section-number">60.3</span> Differentation rules</a>
  <ul class="collapse">
  <li><a href="#sum-and-product-rules-for-the-derivative" id="toc-sum-and-product-rules-for-the-derivative" class="nav-link" data-scroll-target="#sum-and-product-rules-for-the-derivative"><span class="header-section-number">60.3.1</span> Sum and product rules for the derivative</a></li>
  <li><a href="#the-chain-rule" id="toc-the-chain-rule" class="nav-link" data-scroll-target="#the-chain-rule"><span class="header-section-number">60.3.2</span> The chain rule</a></li>
  <li><a href="#computational-differences-with-expressions-from-the-chain-rule" id="toc-computational-differences-with-expressions-from-the-chain-rule" class="nav-link" data-scroll-target="#computational-differences-with-expressions-from-the-chain-rule"><span class="header-section-number">60.3.3</span> Computational differences with expressions from the chain rule</a></li>
  </ul></li>
  <li><a href="#derivatives-of-matrix-functions" id="toc-derivatives-of-matrix-functions" class="nav-link" data-scroll-target="#derivatives-of-matrix-functions"><span class="header-section-number">60.4</span> Derivatives of matrix functions</a>
  <ul class="collapse">
  <li><a href="#vectorization-of-a-matrix" id="toc-vectorization-of-a-matrix" class="nav-link" data-scroll-target="#vectorization-of-a-matrix"><span class="header-section-number">60.4.1</span> Vectorization of a matrix</a></li>
  <li><a href="#kronecker-products" id="toc-kronecker-products" class="nav-link" data-scroll-target="#kronecker-products"><span class="header-section-number">60.4.2</span> Kronecker products</a></li>
  </ul></li>
  <li><a href="#the-adjoint-method" id="toc-the-adjoint-method" class="nav-link" data-scroll-target="#the-adjoint-method"><span class="header-section-number">60.5</span> The adjoint method</a></li>
  <li><a href="#second-derivatives-hessian" id="toc-second-derivatives-hessian" class="nav-link" data-scroll-target="#second-derivatives-hessian"><span class="header-section-number">60.6</span> Second derivatives, Hessian</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/differentiable_vector_calculus/matrix_calculus_notes.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../differentiable_vector_calculus.html">Differential vector calculus</a></li><li class="breadcrumb-item"><a href="../differentiable_vector_calculus/matrix_calculus_notes.html"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Matrix calculus</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Matrix calculus</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This section illustrates a more general setting for taking derivatives, that unifies the different expositions taken prior.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Based on Bright, Edelman, and Johnson’s notes
</div>
</div>
<div class="callout-body-container callout-body">
<p>This section has essentially no original contribution, as it basically samples material from the notes <a href="https://arxiv.org/abs/2501.14787">Matrix Calculus (for Machine Learning and Beyond)</a> by Paige Bright, Alan Edelman, and Steven G. Johnson. Their notes cover material taught in a course at MIT. Support materials for their course in <code>Julia</code> are available at <a href="https://github.com/mitmath/matrixcalc/tree/main">https://github.com/mitmath/matrixcalc/tree/main</a>. For more details and examples, please refer to the source.</p>
</div>
</div>
<section id="review" class="level2" data-number="60.1">
<h2 data-number="60.1" class="anchored" data-anchor-id="review"><span class="header-section-number">60.1</span> Review</h2>
<p>We have seen several “derivatives” of a function, based on the number of inputs and outputs. The first one was for functions <span class="math inline">\(f: R \rightarrow R\)</span>.</p>
<p>In this case, we saw that <span class="math inline">\(f\)</span> has a derivative at <span class="math inline">\(c\)</span> if this limit exists:</p>
<p><span class="math display">\[
\lim_{h \rightarrow 0}\frac{f(c + h) - f(c)}{h}.
\]</span></p>
<p>The derivative as a function of <span class="math inline">\(x\)</span> uses this rule for any <span class="math inline">\(x\)</span> in the domain.</p>
<p>Common notation is:</p>
<p><span class="math display">\[
f'(x) = \frac{dy}{dx} = \lim_{h \rightarrow 0}\frac{f(x + h) - f(x)}{h}
\]</span></p>
<p>(when the limit exists).</p>
<p>This limit gets re-expressed in different ways:</p>
<ul>
<li><p>linearization writes <span class="math inline">\(f(x+\Delta x) - f(x) \approx f'(x)\Delta x\)</span>, where <span class="math inline">\(\Delta x\)</span> is a small displacement from <span class="math inline">\(x\)</span>. The reason there isn’t equality is the unwritten higher order terms that vanish in a limit.</p></li>
<li><p>Alternate limits. Another way of writing this is in terms of explicit smaller order terms:</p></li>
</ul>
<p><span class="math display">\[
(f(x+h) - f(x)) - f'(x)h = \mathscr{o}(h),
\]</span></p>
<p>which means if we divide both sides by <span class="math inline">\(h\)</span> and take the limit, we will get <span class="math inline">\(0\)</span> on the right and the relationship on the left.</p>
<ul>
<li>Differential notation simply writes this as <span class="math inline">\(dy = f'(x)dx\)</span>. Focusing on <span class="math inline">\(f\)</span> and not <span class="math inline">\(y=f(x)\)</span>, we might write</li>
</ul>
<p><span class="math display">\[
df = f(x+dx) - f(x) = f'(x) dx.
\]</span></p>
<p>In the above, <span class="math inline">\(df\)</span> and <span class="math inline">\(dx\)</span> are differentials, made rigorous by a limit, which hides the higher order terms.</p>
<p>We will see all the derivatives encountered so far can be similarly expressed as this last characterization.</p>
<section id="univariate-vector-valued" class="level3" data-number="60.1.1">
<h3 data-number="60.1.1" class="anchored" data-anchor-id="univariate-vector-valued"><span class="header-section-number">60.1.1</span> Univariate, vector-valued</h3>
<p>For example, when <span class="math inline">\(f: R \rightarrow R^m\)</span> was a vector-valued function the derivative was defined similarly through a limit of <span class="math inline">\((f(t + \Delta t) - f(t))/{\Delta t}\)</span>, where each component needed to have a limit. This can be rewritten through <span class="math inline">\(f(t + dt) - f(t) = f'(t) dt\)</span>, again using differentials to avoid the higher order terms.</p>
</section>
<section id="multivariate-scalar-valued" class="level3" data-number="60.1.2">
<h3 data-number="60.1.2" class="anchored" data-anchor-id="multivariate-scalar-valued"><span class="header-section-number">60.1.2</span> Multivariate, scalar-valued</h3>
<p>When <span class="math inline">\(f: R^n \rightarrow R\)</span> is a scalar-valued function with vector inputs, differentiability was defined by a gradient existing with <span class="math inline">\(f(c+h) - f(c) - \nabla{f}(c) \cdot h\)</span> being <span class="math inline">\(\mathscr{o}(\|h\|)\)</span>. In other words <span class="math inline">\(df = f(c + dh) - f(c) = \nabla{f}(c) \cdot dh\)</span>. The gradient has the same shape as <span class="math inline">\(c\)</span>, a column vector. If we take the row vector (e.g.&nbsp;<span class="math inline">\(f'(c) = \nabla{f}(c)^T\)</span>) then again we see <span class="math inline">\(df = f(c+dh) - f(c) = f'(c) dh\)</span>, where the last term uses matrix multiplication of a row vector times a column vector.</p>
</section>
<section id="multivariate-vector-valued" class="level3" data-number="60.1.3">
<h3 data-number="60.1.3" class="anchored" data-anchor-id="multivariate-vector-valued"><span class="header-section-number">60.1.3</span> Multivariate, vector-valued</h3>
<p>Finally, when <span class="math inline">\(f:R^n \rightarrow R^m\)</span>, the Jacobian was defined and characterized by <span class="math inline">\(\| f(x + dx) - f(x) - J_f(x)dx \|\)</span> being <span class="math inline">\(\mathscr{o}(\|dx\|)\)</span>. Again, we can express this through <span class="math inline">\(df = f(x + dx) - f(x) = f'(x)dx\)</span> where <span class="math inline">\(f'(x) = J_f(x)\)</span>.</p>
</section>
<section id="vector-spaces" class="level3" data-number="60.1.4">
<h3 data-number="60.1.4" class="anchored" data-anchor-id="vector-spaces"><span class="header-section-number">60.1.4</span> Vector spaces</h3>
<p>The generalization of the derivative involves linear operators which are defined for vector spaces.</p>
<p>A <a href="https://en.wikipedia.org/wiki/Vector_space">vector space</a> is a set of mathematical objects which can be added together and also multiplied by a scalar. Vectors of similar size, as previously discussed, are the typical example, with vector addition and scalar multiplication already defined. Matrices of similar size (and some subclasses) also form a vector space.</p>
<p>Additionally, many other set of objects form vector spaces. Certain families of functions form examples such as: polynomial functions of degree <span class="math inline">\(n\)</span> or less; continuous functions, or functions with a certain number of derivatives. The last two are infinite dimensional; our focus here is on finite dimensional vector spaces.</p>
<p>Let’s take differentiable functions as an example. These form a vector space as the derivative of a linear combination of differentiable functions is defined through the simplest derivative rule: <span class="math inline">\([af(x) + bg(x)]' = a[f(x)]' + b[g(x)]'\)</span>. If <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are differentiable, then so is <span class="math inline">\(af(x)+bg(x)\)</span>.</p>
<p>A finite vector space is described by a <em>basis</em>—a minimal set of vectors needed to describe the space, after consideration of linear combinations. For some typical vector spaces, this is the set of special vectors with <span class="math inline">\(1\)</span> as one of the entries, and <span class="math inline">\(0\)</span> otherwise.</p>
<p>A key fact about a basis for a finite vector space is every vector in the vector space can be expressed <em>uniquely</em> as a linear combination of the basis vectors. The set of numbers used in the linear combination, along with an order to the basis, means an element in a finite vector space can be associated with a unique coordinate vector.</p>
<p>Vectors and matrices have properties that are generalizations of the real numbers. As vectors and matrices form vector spaces, the concept of addition of vectors and matrices is defined, as is scalar multiplication. Additionally, we have seen:</p>
<ul>
<li><p>The dot product between two vectors of the same length is defined easily (<span class="math inline">\(v\cdot w = \Sigma_i v_i w_i\)</span>). It is coupled with the length as <span class="math inline">\(\|v\|^2 = v\cdot v\)</span>.</p></li>
<li><p>Matrix multiplication is defined for two properly sized matrices. If <span class="math inline">\(A\)</span> is <span class="math inline">\(m \times k\)</span> and <span class="math inline">\(B\)</span> is <span class="math inline">\(k \times n\)</span> then <span class="math inline">\(AB\)</span> is a <span class="math inline">\(m\times n\)</span> matrix with <span class="math inline">\((i,j)\)</span> term given by the dot product of the <span class="math inline">\(i\)</span>th row of <span class="math inline">\(A\)</span> (viewed as a vector) and the <span class="math inline">\(j\)</span>th column of <span class="math inline">\(B\)</span> (viewed as a vector). Matrix multiplication is associative but <em>not</em> commutative. (E.g. <span class="math inline">\((AB)C = A(BC)\)</span> but <span class="math inline">\(AB\)</span> and <span class="math inline">\(BA\)</span> need not be equal, or even defined, as the shapes may not match up.)</p></li>
<li><p>A square matrix <span class="math inline">\(A\)</span> has an <em>inverse</em> <span class="math inline">\(A^{-1}\)</span> if <span class="math inline">\(AA^{-1} = A^{-1}A = I\)</span>, where <span class="math inline">\(I\)</span> is the identity matrix (a matrix which is zero except on its diagonal entries, which are all <span class="math inline">\(1\)</span>). Square matrices may or may not have an inverse. A matrix without an inverse is called <em>singular</em>.</p></li>
<li><p>Viewing a vector as a matrix is possible. The association chosen here is common and is through a <em>column</em> vector.</p></li>
<li><p>The <em>transpose</em> of a matrix comes by permuting the rows and columns. The transpose of a column vector is a row vector, so <span class="math inline">\(v\cdot w = v^T w\)</span>, where we use a superscript <span class="math inline">\(T\)</span> for the transpose. The transpose of a product, is the product of the transposes—reversed: <span class="math inline">\((AB)^T = B^T A^T\)</span>; the transpose of a transpose is an identity operation: <span class="math inline">\((A^T)^T = A\)</span>; the inverse of a transpose is the transpose of the inverse: <span class="math inline">\((A^{-1})^T = (A^T)^{-1}\)</span>.</p></li>
<li><p>Matrices for which <span class="math inline">\(A = A^T\)</span> are called symmetric.</p></li>
<li><p>The <em>adjoint</em> of a matrix is related to the transpose, only complex conjugates are also taken. When a matrix has real components, the adjoint and transpose are identical operations.</p></li>
<li><p>The trace of a square matrix is just the sum of its diagonal terms</p></li>
<li><p>The determinant of a square matrix is involved to compute, but was previously seen to have a relationship to the volume of a certain parallellpiped.</p></li>
</ul>
<p>These operations have different inputs and outputs: the determinant and trace take a (square) matrix and return a scalar; the inverse takes a square matrix and returns a square matrix (when defined); the transpose and adjoint take a rectangular matrix and return a rectangular matrix.</p>
<p>In addition to these, there are a few other key operations on matrices described in the following.</p>
</section>
<section id="linear-operators" class="level3" data-number="60.1.5">
<h3 data-number="60.1.5" class="anchored" data-anchor-id="linear-operators"><span class="header-section-number">60.1.5</span> Linear operators</h3>
<p>The <span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> notes cover differentiation of functions in this uniform manner extending the form by treating derivatives more generally as <em>linear operators</em>.</p>
<p>A <a href="https://en.wikipedia.org/wiki/Operator_(mathematics)">linear operator</a> is a mathematical object which satisfies</p>
<p><span class="math display">\[
f[\alpha v + \beta w] = \alpha f[v] + \beta f[w].
\]</span></p>
<p>where the <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are scalars, and <span class="math inline">\(v\)</span> and <span class="math inline">\(w\)</span> come from a <em>vector space</em>.</p>
<p>Taking the real numbers as a vector space, then regular multiplication is a linear operation, as <span class="math inline">\(c \cdot (ax + by) = a\cdot(cx) + b\cdot(cy)\)</span> using the distributive and commutative properties.</p>
<p>Taking <span class="math inline">\(n\)</span>-dimensional vectors as vector space, matrix multiplication by an <span class="math inline">\(n \times n\)</span> matrix on the left will be a linear operator as <span class="math inline">\(M(av + bw) = a(Mv) + b(Mw)\)</span>, using distribution and the commutative properties of scalar multiplication.</p>
<p>We saw differential functions form a vector space, the derivative is a linear operator, as <span class="math inline">\([af(x) + bg(x)]' = af'(x) + bg'(x)\)</span>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The use of <code>[]</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>The referenced notes identify <span class="math inline">\(f'(x) dx\)</span> as <span class="math inline">\(f'(x)[dx]\)</span>, the latter emphasizing <span class="math inline">\(f'(x)\)</span> acts on <span class="math inline">\(dx\)</span> and the notation is not commutative (e.g., it is not <span class="math inline">\(dx f'(x)\)</span>). The use of <span class="math inline">\([]\)</span> is to indicate that <span class="math inline">\(f'(x)\)</span> “acts” on <span class="math inline">\(dx\)</span> in a linear manner. It may be multiplication, matrix multiplication, or something else. Parentheses are not used which might imply function application or multiplication.</p>
</div>
</div>
</section>
</section>
<section id="the-derivative-as-a-linear-operator" class="level2" data-number="60.2">
<h2 data-number="60.2" class="anchored" data-anchor-id="the-derivative-as-a-linear-operator"><span class="header-section-number">60.2</span> The derivative as a linear operator</h2>
<p>We take the view that a derivative is a linear operator where <span class="math inline">\(df = f(x+dx) + f(x) = f'(x)[dx]\)</span>.</p>
<p>In writing <span class="math inline">\(df = f(x + dx) - f(x) = f'(x)[dx]\)</span> generically, some underlying facts are left implicit: <span class="math inline">\(dx\)</span> has the same shape as <span class="math inline">\(x\)</span> (so can be added) and there is an underlying concept of distance and size that allows the above to be made rigorous. This may be an absolute value or a norm.</p>
<section id="example-directional-derivatives" class="level5">
<h5 class="anchored" data-anchor-id="example-directional-derivatives">Example: directional derivatives</h5>
<p>Suppose <span class="math inline">\(f: R^n \rightarrow R\)</span>, a scalar-valued function of a vector. Then the directional derivative at <span class="math inline">\(x\)</span> in the direction <span class="math inline">\(v\)</span> was defined for a scalar <span class="math inline">\(\alpha\)</span> by:</p>
<p><span class="math display">\[
\frac{\partial}{\partial \alpha}f(x + \alpha v) \mid_{\alpha = 0} =
\lim_{\Delta\alpha \rightarrow 0} \frac{f(x + \Delta\alpha v) - f(x)}{\Delta\alpha}.
\]</span></p>
<p>This rate of change in the direction of <span class="math inline">\(v\)</span> can be expressed through the linear operator <span class="math inline">\(f'(x)\)</span> via</p>
<p><span class="math display">\[
df = f(x + d\alpha v) - f(x) = f'(x) [d\alpha v] = d\alpha f'(x)[v],
\]</span></p>
<p>using linearity to move the scalar multiplication by <span class="math inline">\(d\alpha\)</span> outside the action of the linear operator. This connects the partial derivative at <span class="math inline">\(x\)</span> in the direction of <span class="math inline">\(v\)</span> with <span class="math inline">\(f'(x)\)</span>:</p>
<p><span class="math display">\[
\frac{\partial}{\partial \alpha}f(x + \alpha v) \mid_{\alpha = 0} =
f'(x)[v].
\]</span></p>
<p>Not only does this give a connection in notation with the derivative, it naturally illustrates how the derivative as a linear operator can act on non-infinitesimal values, in this case on <span class="math inline">\(v\)</span>.</p>
<p>Previously, we wrote <span class="math inline">\(\nabla f \cdot v\)</span> for the directional derivative, where the gradient is a column vector.</p>
<p>The above uses the identification <span class="math inline">\(f' = (\nabla f)^T\)</span>. For <span class="math inline">\(f: R^n \rightarrow R\)</span> we have <span class="math inline">\(df = f(x + dx) - f(x) = f'(x) [dx]\)</span> is a scalar, so if <span class="math inline">\(dx\)</span> is a column vector, <span class="math inline">\(f'(x)\)</span> is a row vector with the same number of components (just as <span class="math inline">\(\nabla f\)</span> is a column vector with the same number of components). The operation <span class="math inline">\(f'(x)[dx]\)</span> is just matrix multiplication, which is a linear operation.</p>
</section>
<section id="example-derivative-of-a-matrix-expression" class="level5">
<h5 class="anchored" data-anchor-id="example-derivative-of-a-matrix-expression">Example: derivative of a matrix expression</h5>
<p><span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> include this example to show that the computation of derivatives using components can be avoided. Consider <span class="math inline">\(f(x) = x^T A x\)</span> where <span class="math inline">\(x\)</span> is a vector in <span class="math inline">\(R^n\)</span> and <span class="math inline">\(A\)</span> is an <span class="math inline">\(n\times n\)</span> matrix. This type of expression is common.</p>
<p>Then <span class="math inline">\(f: R^n \rightarrow R\)</span> and its derivative can be computed:</p>
<p><span class="math display">\[
\begin{align*}
df &amp;= f(x + dx) - f(x)\\
&amp;= (x + dx)^T A (x + dx) - x^TAx \\
&amp;= \textcolor{blue}{x^TAx} + dx^TA x + x^TAdx + \textcolor{red}{dx^T A dx} - \textcolor{blue}{x^TAx}\\
&amp;= dx^TA x + x^TAdx \\
&amp;= (dx^TAx)^T + x^TAdx \\
&amp;= x^T A^T dx + x^T A dx\\
&amp;= x^T(A^T + A) dx
\end{align*}
\]</span></p>
<p>The term <span class="math inline">\(dx^t A dx\)</span> is dropped, as it is higher order (goes to zero faster), it containing two <span class="math inline">\(dx\)</span> terms. In the second to last step, an identity operation (taking the transpose of the scalar quantity) is taken to simplify the algebra. Finally, as <span class="math inline">\(df = f'(x)[dx]\)</span> the identity of <span class="math inline">\(f'(x) =  x^T(A^T+A)\)</span> is made, or taking transposes <span class="math inline">\(\nabla f(x) = (A + A^T)x\)</span>.</p>
<p>Compare the elegance above with the component version, even though simplified, which still requires a specification of the size to carry the following out:</p>
<div id="2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SymPy</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@syms</span> x[<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>]<span class="op">::</span><span class="dt">real </span>A[<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>]<span class="op">::</span><span class="dt">real</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> x<span class="op">'</span> <span class="op">*</span> A <span class="op">*</span> x</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>grad_u <span class="op">=</span> [<span class="fu">diff</span>(u, xi) for xi <span class="kw">in</span> x]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p><span class="math inline">\(\left[\begin{smallmatrix}2 A₁_{₁} x₁ + A₁_{₂} x₂ + A₁_{₃} x₃ + A₂_{₁} x₂ + A₃_{₁} x₃\\A₁_{₂} x₁ + A₂_{₁} x₁ + 2 A₂_{₂} x₂ + A₂_{₃} x₃ + A₃_{₂} x₃\\A₁_{₃} x₁ + A₂_{₃} x₂ + A₃_{₁} x₁ + A₃_{₂} x₂ + 2 A₃_{₃} x₃\end{smallmatrix}\right]\)</span></p>
</div>
</div>
<p>Compare to the formula for the gradient just derived:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>grad_u_1 <span class="op">=</span> (A <span class="op">+</span> A<span class="op">'</span>)<span class="op">*</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p><span class="math inline">\(\left[\begin{smallmatrix}2 A₁_{₁} x₁ + x₂ \left(A₁_{₂} + A₂_{₁}\right) + x₃ \left(A₁_{₃} + A₃_{₁}\right)\\2 A₂_{₂} x₂ + x₁ \left(A₁_{₂} + A₂_{₁}\right) + x₃ \left(A₂_{₃} + A₃_{₂}\right)\\2 A₃_{₃} x₃ + x₁ \left(A₁_{₃} + A₃_{₁}\right) + x₂ \left(A₂_{₃} + A₃_{₂}\right)\end{smallmatrix}\right]\)</span></p>
</div>
</div>
<p>The two are, of course, equal</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(a <span class="op">==</span> b <span class="cf">for</span> (a,b) <span class="op">∈</span> <span class="fu">zip</span>(grad_u, grad_u_1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
</section>
<section id="example-derivative-of-matrix-application" class="level5">
<h5 class="anchored" data-anchor-id="example-derivative-of-matrix-application">Example: derivative of matrix application</h5>
<p>For <span class="math inline">\(f: R^n \rightarrow R^m\)</span>, <span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> give an example of computing the Jacobian without resorting to component wise computations. Let <span class="math inline">\(f(x) = Ax\)</span> with <span class="math inline">\(A\)</span> being a <span class="math inline">\(m \times n\)</span> matrix, it follows that</p>
<p><span class="math display">\[
\begin{align*}
df &amp;= f(x + dx) - f(x)\\
&amp;= A(x + dx) - Ax\\
&amp;= Adx\\
&amp;= f'(x)[dx].
\end{align*}
\]</span></p>
<p>The Jacobian is the linear operator <span class="math inline">\(A\)</span> acting on <span class="math inline">\(dx\)</span>. (Seeing that <span class="math inline">\(Adx = f'(x)[dx]\)</span> implies <span class="math inline">\(f'(x)=A\)</span> comes as this action is true for any <span class="math inline">\(dx\)</span>, hence the actions must be the same.)</p>
</section>
</section>
<section id="differentation-rules" class="level2" data-number="60.3">
<h2 data-number="60.3" class="anchored" data-anchor-id="differentation-rules"><span class="header-section-number">60.3</span> Differentation rules</h2>
<p>Various differentiation rules are still available such as the sum, product, and chain rules.</p>
<section id="sum-and-product-rules-for-the-derivative" class="level3" data-number="60.3.1">
<h3 data-number="60.3.1" class="anchored" data-anchor-id="sum-and-product-rules-for-the-derivative"><span class="header-section-number">60.3.1</span> Sum and product rules for the derivative</h3>
<p>Using the differential notation—which implicitly ignores higher order terms as they vanish in a limit—the sum and product rules can be derived.</p>
<p>For the sum rule, let <span class="math inline">\(f(x) = g(x) + h(x)\)</span>. Then</p>
<p><span class="math display">\[
\begin{align*}
df &amp;= f(x + dx) - f(x) \\
&amp;= f'(x)[dx]\\
&amp;= \left(g(x+dx) + h(x+dx)\right) - \left(g(x) + h(x)\right)\\
&amp;= \left(g(x + dx) - g(x)\right) + \left(h(x + dx) - h(x)\right)\\
&amp;= g'(x)[dx] + h'(x)[dx]\\
&amp;= \left(g'(x) + h'(x)\right)[dx]
\end{align*}
\]</span></p>
<p>Comparing we get <span class="math inline">\(f'(x)[dx] = (g'(x) + h'(x))[dx]\)</span> or <span class="math inline">\(f'(x) = g'(x) + h'(x)\)</span>. (The last two lines above show how the new linear operator <span class="math inline">\(g'(x) + h'(x)\)</span> is defined on a value, but adding the application for each.</p>
<p>The sum rule has the same derivation as was done with univariate, scalar functions. Similarly for the product rule.</p>
<p>The product rule for <span class="math inline">\(f(x) = g(x)h(x)\)</span> comes as:</p>
<p><span class="math display">\[
\begin{align*}
df &amp;= f(x + dx) - f(x) \\
&amp;= g(x+dx)h(x + dx) - g(x) h(x)\\
&amp;= \left(g(x) + g'(x)[dx]\right)\left(h(x) + h'(x) [dx]\right) - g(x) h(x) \\
&amp;= \textcolor{blue}{g(x)h(x)} + g'(x) [dx] h(x) + g(x) h'(x) [dx] + \textcolor{red}{g'(x)[dx] h'(x) [dx]} - \textcolor{blue}{g(x) h(x)}\\
&amp;= \left(g'(x)[dx]\right)h(x)  + g(x)\left(h'(x) [dx]\right)\\
&amp;= dg h + g dh
\end{align*}
\]</span></p>
<p><strong>after</strong> dropping the higher order term and cancelling <span class="math inline">\(gh\)</span> terms of opposite signs in the fourth row.</p>
<section id="example" class="level5">
<h5 class="anchored" data-anchor-id="example">Example</h5>
<p>These two rules can be used to directly show the last two examples.</p>
<p>First, if <span class="math inline">\(f(x) = Ax\)</span> and <span class="math inline">\(A\)</span> is a constant, then:</p>
<p><span class="math display">\[
df = (dA)x + A(dx) = 0x + A dx = A dx,
\]</span></p>
<p>Next, to differentiate <span class="math inline">\(f(x) = x^TAx\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
df &amp;= dx^T (Ax) + x^T d(Ax) \\
&amp;= (dx^T (Ax))^T + x^T A dx \\
&amp;= x^T A^T dx + x^T A dx \\
&amp;= x^T(A^T + A) dx
\end{align*}
\]</span></p>
<p>In the second line the transpose of the scalar quantity <span class="math inline">\(x^TAdx\)</span> it taken to simplify the expression and the first calculation is used.</p>
<p>When <span class="math inline">\(A^T = A\)</span> (<span class="math inline">\(A\)</span> is symmetric) this simplifies to a more familiar looking <span class="math inline">\(2x^TA\)</span>, but we see that this requires assumptions not needed in the scalar case.</p>
</section>
<section id="example-1" class="level5">
<h5 class="anchored" data-anchor-id="example-1">Example</h5>
<p><span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> consider what in <code>Julia</code> is <code>.*</code>. That is the operation:</p>
<p><span class="math display">\[
v .* w =
\begin{bmatrix}
v_1w_1 \\
v_2w_2 \\
\vdots\\
v_nw_n
\end{bmatrix}
=
\begin{bmatrix}
v_1 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; v_2 &amp; \cdots &amp; 0 \\
  &amp;     &amp; \vdots &amp;   \\
0 &amp; 0 &amp; \cdots   &amp; v_n
\end{bmatrix}
\begin{bmatrix}
w_1 \\
w_2 \\
\vdots\\
w_n
\end{bmatrix}
= \text{diag}(v) w.
\]</span></p>
<p>They compute the derivative of <span class="math inline">\(f(x) = A(x .* x)\)</span> for some fixed matrix <span class="math inline">\(A\)</span> of the proper size.</p>
<p>We can see by the product rule that <span class="math inline">\(d (\text{diag}(v)w) = d(\text{diag}(v)) w + \text{diag}(v) dw = (dx) .* w + x .* dw\)</span>. So</p>
<p><span class="math inline">\(df = A(dx .* x + x .* dx) = 2A(x .* dx)\)</span>, as <span class="math inline">\(.*\)</span> is commutative by its definition. Writing this as <span class="math inline">\(df = 2A(x .* dx) = 2A(\text{diag}(x) dx) = (2A\text{diag}(x)) dx\)</span>, we identify <span class="math inline">\(f'(x) = 2A\text{diag}(x)\)</span>.</p>
<p>This operation is called the <a href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)">Hadamard product</a> and it extends to matrices and arrays.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Numerator layout
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Wikipedia page on <a href="https://en.wikipedia.org/wiki/Matrix_calculus#Layout_conventions">matrix calculus</a> has numerous such “identities” for derivatives of different common matrix/vector expressions. As vectors are viewed as column vectors; the “numerator layout” identities apply.</p>
</div>
</div>
</section>
</section>
<section id="the-chain-rule" class="level3" data-number="60.3.2">
<h3 data-number="60.3.2" class="anchored" data-anchor-id="the-chain-rule"><span class="header-section-number">60.3.2</span> The chain rule</h3>
<p>Like the product rule, the chain rule is shown by <span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> in this notation with <span class="math inline">\(f(x) = g(h(x))\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
df &amp;= f(x + dx) - f(x)\\
&amp;= g(h(x + dx)) - g(h(x))\\
&amp;= g(h(x) + h'(x)[dx]) - g(h(x))\\
&amp;= g(h(x)) + g'(h(x))[h'(x)[dx]] - g(h(x))\\
&amp;= g'(h(x)) [h'(x) [dx]]\\
&amp;= (g'(h(x)) h'(x)) [dx]
\end{align*}
\]</span></p>
<p>The operator <span class="math inline">\(f'(x)= g'(h(x)) h'(x)\)</span> is a product of matrices.</p>
</section>
<section id="computational-differences-with-expressions-from-the-chain-rule" class="level3" data-number="60.3.3">
<h3 data-number="60.3.3" class="anchored" data-anchor-id="computational-differences-with-expressions-from-the-chain-rule"><span class="header-section-number">60.3.3</span> Computational differences with expressions from the chain rule</h3>
<p>Of note here is the application of the chain rule to three (or more compositions) where <span class="math inline">\(c:R^n \rightarrow R^j\)</span>, <span class="math inline">\(b:R^j \rightarrow R^k\)</span>, and <span class="math inline">\(a:R^k \rightarrow R^m\)</span>:</p>
<p>If <span class="math inline">\(f(x) = a(b(c(x)))\)</span> then the derivative is:</p>
<p><span class="math display">\[
f'(x) = a'(b(c(x))) b'(c(x)) c'(x),
\]</span></p>
<p>which can be expressed as three matrix multiplications two ways:</p>
<p><span class="math display">\[
f' = (a'b')c'  \text{ or } f' = a'(b'c')
\]</span></p>
<p>Multiplying left to right (the first) is called reverse mode; multiplying right to left (the second) is called forward mode. The distinction becomes important when considering the computational cost of the multiplications.</p>
<ul>
<li>If <span class="math inline">\(f: R^n \rightarrow R^m\)</span> has <span class="math inline">\(n\)</span> much bigger than <span class="math inline">\(1\)</span> and <span class="math inline">\(m=1\)</span>, then it is much faster to do left to right multiplication (many more inputs than outputs)</li>
<li>if <span class="math inline">\(f:R^n \rightarrow R^m\)</span> has <span class="math inline">\(n=1\)</span> and <span class="math inline">\(m\)</span> much bigger than one, the it is faster to do right to left multiplication (many outputs than inputs)</li>
</ul>
<p>The reason comes down to the shape of the matrices. To see, we need to know that matrix multiplication of an <span class="math inline">\(m \times q\)</span> matrix times a <span class="math inline">\(q \times n\)</span> matrix takes an order of <span class="math inline">\(mqn\)</span> operations.</p>
<p>When <span class="math inline">\(m=1\)</span>, the derivative is a product of matrices of size <span class="math inline">\(n\times j\)</span>, <span class="math inline">\(j\times k\)</span>, and <span class="math inline">\(k \times 1\)</span> yielding a matrix of size <span class="math inline">\(n \times 1\)</span> matching the function dimension.</p>
<p>The operations involved in multiplication from left to right can be quantified. The first operation takes <span class="math inline">\(njk\)</span> operation leaving an <span class="math inline">\(n\times k\)</span> matrix, the next multiplication then takes another <span class="math inline">\(nk1\)</span> operations or <span class="math inline">\(njk + nk\)</span> together.</p>
<p>Whereas computing from the right to left is first <span class="math inline">\(jk1\)</span> operations leaving a <span class="math inline">\(j \times 1\)</span> matrix. The next operation would take another <span class="math inline">\(nk1\)</span> operations. In total:</p>
<ul>
<li>left to right is <span class="math inline">\(njk + nk\)</span> = <span class="math inline">\(nk \cdot (j + 1)\)</span>.</li>
<li>right to left is <span class="math inline">\(jk + jn = j\cdot (k+n)\)</span>.</li>
</ul>
<p>When <span class="math inline">\(j=k\)</span>, say, we can compare and see the second is a factor less in terms of operations. This can be quite significant in higher dimensions.</p>
<section id="example-2" class="level5">
<h5 class="anchored" data-anchor-id="example-2">Example</h5>
<p>Using the <code>BenchmarkTools</code> package, we can check the time to compute various products:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BenchmarkTools</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n,j,k,m <span class="op">=</span> <span class="fl">20</span>,<span class="fl">15</span>,<span class="fl">10</span>,<span class="fl">1</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">A*</span>(B<span class="op">*</span>C) setup<span class="op">=</span>(A<span class="op">=</span><span class="fu">rand</span>(n,j); B<span class="op">=</span><span class="fu">rand</span>(j,k); C<span class="op">=</span><span class="fu">rand</span>(k,m));</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> (A<span class="op">*</span>B)<span class="op">*</span>C setup<span class="op">=</span>(A<span class="op">=</span><span class="fu">rand</span>(n,j); B<span class="op">=</span><span class="fu">rand</span>(j,k); C<span class="op">=</span><span class="fu">rand</span>(k,m));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  161.511 ns (4 allocations: 432 bytes)
  289.207 ns (4 allocations: 1.88 KiB)</code></pre>
</div>
</div>
<p>The latter computation is about 1.5 times slower.</p>
<p>Whereas the relationship is changed when the first matrix is skinny and the last is not:</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">A*</span>(B<span class="op">*</span>C) setup<span class="op">=</span>(A<span class="op">=</span><span class="fu">rand</span>(m,k); B<span class="op">=</span><span class="fu">rand</span>(k,j); C<span class="op">=</span><span class="fu">rand</span>(j,n));</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> (A<span class="op">*</span>B)<span class="op">*</span>C setup<span class="op">=</span>(A<span class="op">=</span><span class="fu">rand</span>(m,k); B<span class="op">=</span><span class="fu">rand</span>(k,j); C<span class="op">=</span><span class="fu">rand</span>(j,n));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  359.976 ns (4 allocations: 1.88 KiB)
  205.310 ns (4 allocations: 432 bytes)</code></pre>
</div>
</div>
<hr>
<p>In calculus, we typically have <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> are <span class="math inline">\(1\)</span>, <span class="math inline">\(2\)</span>,or <span class="math inline">\(3\)</span>. But that need not be the case, especially if differentiation is over a parameter space.</p>
</section>
</section>
</section>
<section id="derivatives-of-matrix-functions" class="level2" data-number="60.4">
<h2 data-number="60.4" class="anchored" data-anchor-id="derivatives-of-matrix-functions"><span class="header-section-number">60.4</span> Derivatives of matrix functions</h2>
<p>What is the the derivative of <span class="math inline">\(f(A) = A^2\)</span>?</p>
<p>The function <span class="math inline">\(f\)</span> takes a <span class="math inline">\(n\times n\)</span> matrix and returns a matrix of the same size.</p>
<p>This derivative can be derived directly from the <em>product rule</em>:</p>
<p><span class="math display">\[
\begin{align*}
df &amp;= d(A^2) = d(AA)\\
&amp;= dA A + A dA
\end{align*}
\]</span></p>
<p>That is <span class="math inline">\(f'(A)\)</span> is the operator <span class="math inline">\(f'(A)[\delta A] = A \delta A + \delta A A\)</span>. (This is not <span class="math inline">\(2A\delta A\)</span>, as <span class="math inline">\(A\)</span> may not commute with <span class="math inline">\(\delta A\)</span>.)</p>
<section id="vectorization-of-a-matrix" class="level3" data-number="60.4.1">
<h3 data-number="60.4.1" class="anchored" data-anchor-id="vectorization-of-a-matrix"><span class="header-section-number">60.4.1</span> Vectorization of a matrix</h3>
<p>Alternatively, we can identify <span class="math inline">\(A\)</span> through its components, as a vector in <span class="math inline">\(R^{n^2}\)</span> and then leverage the Jacobian.</p>
<p>One such identification is vectorization—consecutively stacking the column vectors into a single vector. In <code>Julia</code> the <code>vec</code> function does this operation:</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@syms</span> A[<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vec</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p><span class="math inline">\(\left[\begin{smallmatrix}A₁_{₁}\\A₂_{₁}\\A₁_{₂}\\A₂_{₂}\end{smallmatrix}\right]\)</span></p>
</div>
</div>
<p>The stacking by column follows how <code>Julia</code> stores matrices and how <code>Julia</code> references entries in a matrix by linear index:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vec</span>(A) <span class="op">==</span> [A[i] for i <span class="kw">in</span> <span class="fu">eachindex</span>(A)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<p>With this vectorization operation, <span class="math inline">\(f\)</span> may be viewed as <span class="math inline">\(\tilde{f}:R^{n^2} \rightarrow R^{n^2}\)</span> through:</p>
<p><span class="math display">\[
\tilde{f}(\text{vec}(A)) = \text{vec}(f(A))
\]</span></p>
<p>We use <code>SymPy</code> to compute the Jacobian of this vector valued function.</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@syms</span> A[<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>]<span class="op">::</span><span class="dt">real</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>J <span class="op">=</span> <span class="fu">vec</span>(<span class="fu">f</span>(A)).<span class="fu">jacobian</span>(<span class="fu">vec</span>(A)) <span class="co"># jacobian of f̃</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p><span class="math inline">\(\left[\begin{smallmatrix}2 A₁_{₁} &amp; A₁_{₂} &amp; A₁_{₃} &amp; A₂_{₁} &amp; 0 &amp; 0 &amp; A₃_{₁} &amp; 0 &amp; 0\\A₂_{₁} &amp; A₁_{₁} + A₂_{₂} &amp; A₂_{₃} &amp; 0 &amp; A₂_{₁} &amp; 0 &amp; 0 &amp; A₃_{₁} &amp; 0\\A₃_{₁} &amp; A₃_{₂} &amp; A₁_{₁} + A₃_{₃} &amp; 0 &amp; 0 &amp; A₂_{₁} &amp; 0 &amp; 0 &amp; A₃_{₁}\\A₁_{₂} &amp; 0 &amp; 0 &amp; A₁_{₁} + A₂_{₂} &amp; A₁_{₂} &amp; A₁_{₃} &amp; A₃_{₂} &amp; 0 &amp; 0\\0 &amp; A₁_{₂} &amp; 0 &amp; A₂_{₁} &amp; 2 A₂_{₂} &amp; A₂_{₃} &amp; 0 &amp; A₃_{₂} &amp; 0\\0 &amp; 0 &amp; A₁_{₂} &amp; A₃_{₁} &amp; A₃_{₂} &amp; A₂_{₂} + A₃_{₃} &amp; 0 &amp; 0 &amp; A₃_{₂}\\A₁_{₃} &amp; 0 &amp; 0 &amp; A₂_{₃} &amp; 0 &amp; 0 &amp; A₁_{₁} + A₃_{₃} &amp; A₁_{₂} &amp; A₁_{₃}\\0 &amp; A₁_{₃} &amp; 0 &amp; 0 &amp; A₂_{₃} &amp; 0 &amp; A₂_{₁} &amp; A₂_{₂} + A₃_{₃} &amp; A₂_{₃}\\0 &amp; 0 &amp; A₁_{₃} &amp; 0 &amp; 0 &amp; A₂_{₃} &amp; A₃_{₁} &amp; A₃_{₂} &amp; 2 A₃_{₃}\end{smallmatrix}\right]\)</span></p>
</div>
</div>
<p>We do this via linear algebra first, then see a more elegant manner following the notes.</p>
<p>A course in linear algebra shows that any linear operator on a finite vector space can be represented as a matrix. The basic idea is to represent what the operator does to each <em>basis</em> element and put these values as columns of the matrix.</p>
<p>In this <span class="math inline">\(3 \times 3\)</span> case, the linear operator works on an object with <span class="math inline">\(9\)</span> slots and returns an object with <span class="math inline">\(9\)</span> slots, so the matrix will be <span class="math inline">\(9 \times 9\)</span>.</p>
<p>The basis elements are simply the matrices with a <span class="math inline">\(1\)</span> in spot <span class="math inline">\((i,j)\)</span> and zero elsewhere. Here we generate them through a function:</p>
<div id="18" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">basis</span>(i,j,A) <span class="op">=</span> (b<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Int</span>, <span class="fu">size</span>(A)<span class="op">...</span>); b[i,j] <span class="op">=</span> <span class="fl">1</span>; b)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>JJ <span class="op">=</span> [<span class="fu">vec</span>(<span class="fu">basis</span>(i,j,A)<span class="op">*</span>A <span class="op">+</span> <span class="fu">A*basis</span>(i,j,A)) for  j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span> for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>9-element Vector{Vector{Sym{PyCall.PyObject}}}:
 [2*A₁_₁, A₂_₁, A₃_₁, A₁_₂, 0, 0, A₁_₃, 0, 0]
 [A₁_₂, A₁_₁ + A₂_₂, A₃_₂, 0, A₁_₂, 0, 0, A₁_₃, 0]
 [A₁_₃, A₂_₃, A₁_₁ + A₃_₃, 0, 0, A₁_₂, 0, 0, A₁_₃]
 [A₂_₁, 0, 0, A₁_₁ + A₂_₂, A₂_₁, A₃_₁, A₂_₃, 0, 0]
 [0, A₂_₁, 0, A₁_₂, 2*A₂_₂, A₃_₂, 0, A₂_₃, 0]
 [0, 0, A₂_₁, A₁_₃, A₂_₃, A₂_₂ + A₃_₃, 0, 0, A₂_₃]
 [A₃_₁, 0, 0, A₃_₂, 0, 0, A₁_₁ + A₃_₃, A₂_₁, A₃_₁]
 [0, A₃_₁, 0, 0, A₃_₂, 0, A₁_₂, A₂_₂ + A₃_₃, A₃_₂]
 [0, 0, A₃_₁, 0, 0, A₃_₂, A₁_₃, A₂_₃, 2*A₃_₃]</code></pre>
</div>
</div>
<p>The elements of <code>JJ</code> show the representation of each of the <span class="math inline">\(9\)</span> basis elements under the linear transformation.</p>
<p>To construct the matrix representing the linear operator, we need to concatenate these horizontally as column vectors</p>
<div id="20" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>JJ <span class="op">=</span> <span class="fu">hcat</span>(JJ<span class="op">...</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p><span class="math inline">\(\left[\begin{smallmatrix}2 A₁_{₁} &amp; A₁_{₂} &amp; A₁_{₃} &amp; A₂_{₁} &amp; 0 &amp; 0 &amp; A₃_{₁} &amp; 0 &amp; 0\\A₂_{₁} &amp; A₁_{₁} + A₂_{₂} &amp; A₂_{₃} &amp; 0 &amp; A₂_{₁} &amp; 0 &amp; 0 &amp; A₃_{₁} &amp; 0\\A₃_{₁} &amp; A₃_{₂} &amp; A₁_{₁} + A₃_{₃} &amp; 0 &amp; 0 &amp; A₂_{₁} &amp; 0 &amp; 0 &amp; A₃_{₁}\\A₁_{₂} &amp; 0 &amp; 0 &amp; A₁_{₁} + A₂_{₂} &amp; A₁_{₂} &amp; A₁_{₃} &amp; A₃_{₂} &amp; 0 &amp; 0\\0 &amp; A₁_{₂} &amp; 0 &amp; A₂_{₁} &amp; 2 A₂_{₂} &amp; A₂_{₃} &amp; 0 &amp; A₃_{₂} &amp; 0\\0 &amp; 0 &amp; A₁_{₂} &amp; A₃_{₁} &amp; A₃_{₂} &amp; A₂_{₂} + A₃_{₃} &amp; 0 &amp; 0 &amp; A₃_{₂}\\A₁_{₃} &amp; 0 &amp; 0 &amp; A₂_{₃} &amp; 0 &amp; 0 &amp; A₁_{₁} + A₃_{₃} &amp; A₁_{₂} &amp; A₁_{₃}\\0 &amp; A₁_{₃} &amp; 0 &amp; 0 &amp; A₂_{₃} &amp; 0 &amp; A₂_{₁} &amp; A₂_{₂} + A₃_{₃} &amp; A₂_{₃}\\0 &amp; 0 &amp; A₁_{₃} &amp; 0 &amp; 0 &amp; A₂_{₃} &amp; A₃_{₁} &amp; A₃_{₂} &amp; 2 A₃_{₃}\end{smallmatrix}\right]\)</span></p>
</div>
</div>
<p>The matrix <span class="math inline">\(JJ\)</span> is identical to <span class="math inline">\(J\)</span>, above:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(j <span class="op">==</span> jj <span class="cf">for</span> (j, jj) <span class="kw">in</span> <span class="fu">zip</span>(J, JJ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
</section>
<section id="kronecker-products" class="level3" data-number="60.4.2">
<h3 data-number="60.4.2" class="anchored" data-anchor-id="kronecker-products"><span class="header-section-number">60.4.2</span> Kronecker products</h3>
<p>But how can we see the Jacobian, <span class="math inline">\(J\)</span>, from the linear operator <span class="math inline">\(f'(A)[\delta A] = \delta A A + A \delta A\)</span>?</p>
<p>To make this less magical, a related operation to <code>vec</code> is defined.</p>
<p>The <span class="math inline">\(\text{vec}\)</span> function takes a matrix and stacks its columns.</p>
<p>The <span class="math inline">\(\text{vec}\)</span> function can turn a matrix into a vector, so it can be used for finding the Jacobian, as above. However the shape of the matrix is lost, as are the fundamental matrix operations, like multiplication.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Kronecker_product">Kronecker product</a> replicates values making a bigger matrix. That is, if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are matrices, the Kronecker product replaces each value in <span class="math inline">\(A\)</span> with that value times <span class="math inline">\(B\)</span>, making a bigger matrix, as each entry in <span class="math inline">\(A\)</span> is replaced by an entry with size <span class="math inline">\(B\)</span>.</p>
<p>Formally,</p>
<p><span class="math display">\[
A \otimes B =
\begin{bmatrix}
a_{11}B &amp; a_{12}B &amp; \cdots &amp; a_{1n}B \\
a_{21}B &amp; a_{22}B &amp; \cdots &amp; a_{2n}B \\
        &amp;\vdots   &amp;        &amp;         \\
a_{m1}B &amp; a_{m2}B &amp; \cdots &amp; a_{mn}B
\end{bmatrix}
\]</span></p>
<p>The function <code>kron</code> forms this product:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@syms</span> A[<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>] B[<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kron</span>(A, B) <span class="co"># same as hcat((vcat((A[i,j]*B for i in 1:2)...) for j in 1:3)...)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p><span class="math inline">\(\left[\begin{smallmatrix}A₁_{₁} B₁_{₁} &amp; A₁_{₁} B₁_{₂} &amp; A₁_{₁} B₁_{₃} &amp; A₁_{₁} B₁_{₄} &amp; A₁_{₂} B₁_{₁} &amp; A₁_{₂} B₁_{₂} &amp; A₁_{₂} B₁_{₃} &amp; A₁_{₂} B₁_{₄} &amp; A₁_{₃} B₁_{₁} &amp; A₁_{₃} B₁_{₂} &amp; A₁_{₃} B₁_{₃} &amp; A₁_{₃} B₁_{₄}\\A₁_{₁} B₂_{₁} &amp; A₁_{₁} B₂_{₂} &amp; A₁_{₁} B₂_{₃} &amp; A₁_{₁} B₂_{₄} &amp; A₁_{₂} B₂_{₁} &amp; A₁_{₂} B₂_{₂} &amp; A₁_{₂} B₂_{₃} &amp; A₁_{₂} B₂_{₄} &amp; A₁_{₃} B₂_{₁} &amp; A₁_{₃} B₂_{₂} &amp; A₁_{₃} B₂_{₃} &amp; A₁_{₃} B₂_{₄}\\A₁_{₁} B₃_{₁} &amp; A₁_{₁} B₃_{₂} &amp; A₁_{₁} B₃_{₃} &amp; A₁_{₁} B₃_{₄} &amp; A₁_{₂} B₃_{₁} &amp; A₁_{₂} B₃_{₂} &amp; A₁_{₂} B₃_{₃} &amp; A₁_{₂} B₃_{₄} &amp; A₁_{₃} B₃_{₁} &amp; A₁_{₃} B₃_{₂} &amp; A₁_{₃} B₃_{₃} &amp; A₁_{₃} B₃_{₄}\\A₂_{₁} B₁_{₁} &amp; A₂_{₁} B₁_{₂} &amp; A₂_{₁} B₁_{₃} &amp; A₂_{₁} B₁_{₄} &amp; A₂_{₂} B₁_{₁} &amp; A₂_{₂} B₁_{₂} &amp; A₂_{₂} B₁_{₃} &amp; A₂_{₂} B₁_{₄} &amp; A₂_{₃} B₁_{₁} &amp; A₂_{₃} B₁_{₂} &amp; A₂_{₃} B₁_{₃} &amp; A₂_{₃} B₁_{₄}\\A₂_{₁} B₂_{₁} &amp; A₂_{₁} B₂_{₂} &amp; A₂_{₁} B₂_{₃} &amp; A₂_{₁} B₂_{₄} &amp; A₂_{₂} B₂_{₁} &amp; A₂_{₂} B₂_{₂} &amp; A₂_{₂} B₂_{₃} &amp; A₂_{₂} B₂_{₄} &amp; A₂_{₃} B₂_{₁} &amp; A₂_{₃} B₂_{₂} &amp; A₂_{₃} B₂_{₃} &amp; A₂_{₃} B₂_{₄}\\A₂_{₁} B₃_{₁} &amp; A₂_{₁} B₃_{₂} &amp; A₂_{₁} B₃_{₃} &amp; A₂_{₁} B₃_{₄} &amp; A₂_{₂} B₃_{₁} &amp; A₂_{₂} B₃_{₂} &amp; A₂_{₂} B₃_{₃} &amp; A₂_{₂} B₃_{₄} &amp; A₂_{₃} B₃_{₁} &amp; A₂_{₃} B₃_{₂} &amp; A₂_{₃} B₃_{₃} &amp; A₂_{₃} B₃_{₄}\end{smallmatrix}\right]\)</span></p>
</div>
</div>
<p>The <span class="math inline">\(m\times n\)</span> matrix <span class="math inline">\(A\)</span> and <span class="math inline">\(j \times k\)</span> matrix <span class="math inline">\(B\)</span> has a Kronecker product with size <span class="math inline">\(mj \times nk\)</span>.</p>
<p>The Kronecker product has a certain algebra, including:</p>
<ul>
<li>transposes: <span class="math inline">\((A \otimes B)^T = A^T \otimes B^T\)</span></li>
<li>orthogonal: <span class="math inline">\((A\otimes B)^T = (A\otimes B)\)</span> if both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> has the same property</li>
<li>trace (sum of diagonal): <span class="math inline">\(\text{tr}(A \otimes B) = \text{tr}(A)\text{tr}(B)\)</span>.* determinants: <span class="math inline">\(\det(A\otimes B) = \det(A)^m \det(B)^n\)</span>, where <span class="math inline">\(A\)</span> is <span class="math inline">\(n\times n\)</span>, <span class="math inline">\(B\)</span> is <span class="math inline">\(m \times m\)</span>.</li>
<li>inverses: <span class="math inline">\((A \otimes B)^{-1} = (A^{-1}) \otimes (B^{-1})\)</span></li>
<li>multiplication: <span class="math inline">\((A\otimes B)(C \otimes D) = (AC) \otimes (BD)\)</span></li>
</ul>
<p>The main equation coupling <code>vec</code> and <code>kron</code> is the fact that if <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span> have appropriate sizes, then:</p>
<p><span class="math display">\[
(A \otimes B) \text{vec}(C) = \text{vec}(B C A^T).
\]</span></p>
<p>Appropriate sizes for <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span> are determined by the various products in <span class="math inline">\(BCA^T\)</span>.</p>
<p>If <span class="math inline">\(A\)</span> is <span class="math inline">\(m \times n\)</span> and <span class="math inline">\(B\)</span> is <span class="math inline">\(r \times s\)</span>, then since <span class="math inline">\(BC\)</span> is defined, <span class="math inline">\(C\)</span> has <span class="math inline">\(s\)</span> rows, and since <span class="math inline">\(CA^T\)</span> is defined, <span class="math inline">\(C\)</span> must have <span class="math inline">\(n\)</span> columns, as <span class="math inline">\(A^T\)</span> is <span class="math inline">\(n \times m\)</span>, so <span class="math inline">\(C\)</span> must be <span class="math inline">\(s\times n\)</span>. Checking this is correct on the other side, <span class="math inline">\(A \times B\)</span> would be size <span class="math inline">\(mr \times ns\)</span> and <span class="math inline">\(\vec{C}\)</span> would be size <span class="math inline">\(sn\)</span>, so that product works, size wise.</p>
<p>The referred to notes have an explanation for this formula, but we only confirm it with an example using <span class="math inline">\(m=n=2\)</span> and <span class="math inline">\(r=s=3\)</span>:</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@syms</span> A[<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>]<span class="op">::</span><span class="dt">real </span>B[<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>]<span class="op">::</span><span class="dt">real </span>C[<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>]<span class="op">::</span><span class="dt">real</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>L, R <span class="op">=</span> <span class="fu">kron</span>(A,B)<span class="fu">*vec</span>(C),  <span class="fu">vec</span>(B<span class="op">*</span>C<span class="op">*</span>A<span class="op">'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(l <span class="op">==</span> r <span class="cf">for</span> (l, r) <span class="op">∈</span> <span class="fu">zip</span>(L, R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<hr>
<p>Now to use this relationship to recognize <span class="math inline">\(df = A dA + dA A\)</span> with the Jacobian computed from <span class="math inline">\(\text{vec}(f(a))\)</span>.</p>
<p>We have <span class="math inline">\(\text{vec}(A dA + dA A) = \text{vec}(A dA) + \text{vec}(dA A)\)</span>, by obvious linearity of <span class="math inline">\(\text{vec}\)</span>. Now inserting an identity matrix, <span class="math inline">\(I\)</span>, which is symmteric, in a useful spot we have:</p>
<p><span class="math display">\[
\text{vec}(A dA) = \text{vec}(A dA I^T) = (I \otimes A) \text{vec}(dA),
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\text{vec}(dA A) = \text{vec}(I dA (A^T)^T) = (A^T \otimes I) \text{vec}(dA).
\]</span></p>
<p>This leaves</p>
<p><span class="math display">\[
\text{vec}(A dA + dA A) =
\left((I \otimes A) + (A^T \otimes I)\right) \text{vec}(dA)
\]</span></p>
<p>We should then get the Jacobian we computed from the following:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@syms</span> A[<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>]<span class="op">::</span><span class="dt">real</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span>: I</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>J <span class="op">=</span> <span class="fu">vec</span>(A<span class="op">^</span><span class="fl">2</span>).<span class="fu">jacobian</span>(<span class="fu">vec</span>(A))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>JJ <span class="op">=</span> <span class="fu">kron</span>(<span class="fu">I</span>(<span class="fl">3</span>), A) <span class="op">+</span> <span class="fu">kron</span>(A<span class="op">'</span>, <span class="fu">I</span>(<span class="fl">3</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(j <span class="op">==</span> jj <span class="cf">for</span> (j,jj) <span class="kw">in</span> <span class="fu">zip</span>(J,JJ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<p>This technique can also be used with other powers, say <span class="math inline">\(f(A) = A^3\)</span>, where the resulting <span class="math inline">\(df = A^2 dA + A dA A + dA A^2\)</span> is one answer that can be compared to a Jacobian through</p>
<p><span class="math display">\[
\begin{align*}
df &amp;= \text{vec}(A^2 dA I^T) + \text{vec}(A dA A) + \text{vec}(I dA A^2)\\
&amp;= (I \otimes A^2)\text{vec}(dA) + (A^T \otimes A) \text{vec}(dA) + ((A^T)^2 \otimes I) \text{vec}(dA)
\end{align*}
\]</span></p>
<p>The above shows how to relate the derivative of a matrix function to the Jacobian of a vectorized function, but only for illustration. It is certainly not necessary to express the derivative of <span class="math inline">\(f\)</span> in terms of the derivative of its vectorized counterpart.</p>
<section id="example-derivative-of-the-matrix-inverse" class="level5">
<h5 class="anchored" data-anchor-id="example-derivative-of-the-matrix-inverse">Example: derivative of the matrix inverse</h5>
<p>What is the derivative of <span class="math inline">\(f(A) = A^{-1}\)</span>? The same technique used to find the derivative of the inverse of a univariate, scalar-valued function is useful. Starting with <span class="math inline">\(I = AA^{-1}\)</span> and noting <span class="math inline">\(dI\)</span> is <span class="math inline">\(0\)</span> we have</p>
<p><span class="math display">\[
\begin{align*}
0 &amp;= d(AA^{-1})\\
&amp;= dAA^{-1} + A d(A^{-1})
\end{align*}
\]</span></p>
<p>So, <span class="math inline">\(d(A^{-1}) = -A^{-1} dA A^{-1}\)</span>.</p>
<p>This could be re-expressed as a linear operator through</p>
<p><span class="math display">\[
\text{vec}(dA^{-1}) =
\left((A^{-1})^T \otimes A^{-1}\right) \text{vec}(dA)
= \left((A^T)^{-1} \otimes A^{-1}\right) \text{vec}(dA).
\]</span></p>
</section>
<section id="example-derivative-of-the-matrix-determinant" class="level5">
<h5 class="anchored" data-anchor-id="example-derivative-of-the-matrix-determinant">Example: derivative of the matrix determinant</h5>
<p>Let <span class="math inline">\(f(A) = \text{det}(A)\)</span>. What is the derivative?</p>
<p>First, the determinant of a square, <span class="math inline">\(n\times n\)</span>, matrix <span class="math inline">\(A\)</span> is a scalar summary of <span class="math inline">\(A\)</span>. There are different means to compute the determinant, but this recursive one in particular is helpful here:</p>
<p><span class="math display">\[
\text{det}(A) =  a_{1j}C_{1j} + a_{2j}C_{2j} + \cdots a_{nj}C_{nj}
\]</span></p>
<p>for any <span class="math inline">\(j\)</span>. The <em>cofactor</em> <span class="math inline">\(C_{ij}\)</span> is the determinant of the <span class="math inline">\((n-1)\times(n-1)\)</span> matrix with the <span class="math inline">\(i\)</span>th row and <span class="math inline">\(j\)</span>th column deleted times <span class="math inline">\((-1)^{i+j}\)</span>.</p>
<p>To find the <em>gradient</em> of <span class="math inline">\(f\)</span>, we differentiate by each of the <span class="math inline">\(A_{ij}\)</span> variables, and so</p>
<p><span class="math display">\[
\frac{\partial\text{det}(A)}{\partial A_{ij}} =
\frac{\partial (a_{1j}C_{1j} + a_{2j}C_{2j} + \cdots a_{nj}C_{nj})}{\partial A_{ij}} =
C_{ij},
\]</span></p>
<p>as each cofactor in the expansion has no dependence on <span class="math inline">\(A_{ij}\)</span> as the cofactor removes the <span class="math inline">\(i\)</span>th row and <span class="math inline">\(j\)</span>th column.</p>
<p>So the gradient is the matrix of cofactors.</p>
<p><span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> also give a different proof, starting with this observation:</p>
<p><span class="math display">\[
\text{det}(I + dA) - \text{det}(I) = \text{tr}(dA).
\]</span></p>
<p>Assuming that, then by the fact <span class="math inline">\(\text{det}(AB) = \text{det}(A)\text{det}(B)\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
\text{det}(A + A(A^{-1}dA)) - \text{det}(A) &amp;= \text{det}(A)\cdot(\text{det}(I+ A^{-1}dA) - \text{det}(I)) \\
&amp;= \text{det}(A) \text{tr}(A^{-1}dA)\\
&amp;= \text{tr}(\text{det}(A)A^{-1}dA).
\end{align*}
\]</span></p>
<p>This agrees through a formula to compute the inverse of a matrix through its cofactor matrix divided by its determinant.</p>
<p>That the trace gets involved, can be seen from this computation, which shows the only first-order terms are from the diagonal sum:</p>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@syms</span> dA[<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(I <span class="op">+</span> dA) <span class="op">-</span> <span class="fu">det</span>(I)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<p><span class="math inline">\(dA₁_{₁} dA₂_{₂} + dA₁_{₁} - dA₁_{₂} dA₂_{₁} + dA₂_{₂}\)</span></p>
</div>
</div>
</section>
</section>
</section>
<section id="the-adjoint-method" class="level2" data-number="60.5">
<h2 data-number="60.5" class="anchored" data-anchor-id="the-adjoint-method"><span class="header-section-number">60.5</span> The adjoint method</h2>
<p>The chain rule brings about a series of products. The adjoint method illustrated by <span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> and summarize below, shows how to approach the computation of the series in a direction that minimizes the computational cost, illustrating why reverse mode is preferred to forward mode when a scalar function of several variables is considered.</p>
<p><span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> consider the derivative of</p>
<p><span class="math display">\[
g(p) = f(A(p)^{-1} b)
\]</span></p>
<p>This might arise from applying a scalar-valued <span class="math inline">\(f\)</span> to the solution of <span class="math inline">\(Ax = b\)</span>, where <span class="math inline">\(A\)</span> is parameterized by <span class="math inline">\(p\)</span>. The number of parameters might be quite large, so how the resulting computation is organized might effect the computational costs.</p>
<p>The chain rule gives the following computation to find the derivative (or gradient):</p>
<p><span class="math display">\[
\begin{align*}
dg
&amp;= f'(x)[dx]\\
&amp;= f'(x) [d(A(p)^{-1} b)]\\
&amp;= f'(x)[-A(p)^{-1} dA A(p)^{-1} b + 0]\\
&amp;= -\textcolor{red}{f'(x) A(p)^{-1}} dA\textcolor{blue}{A(p)^{-1}[b]}.
\end{align*}
\]</span></p>
<p>By setting <span class="math inline">\(v^T = f'(x)A(p)^{-1}\)</span> and writing <span class="math inline">\(x = A(p)^{-1}[b]\)</span> this becomes</p>
<p><span class="math display">\[
dg = -v^T dA x.
\]</span></p>
<p>This product of three terms can be computed in two directions:</p>
<p><em>From left to right:</em></p>
<p>First <span class="math inline">\(v\)</span> is found by solving <span class="math inline">\(v^T = f'(x) A^{-1}\)</span> through the solving of <span class="math inline">\(v = (A^{-1})^T (f'(x))^T = (A^T)^{-1} \nabla(f)\)</span> or by solving <span class="math inline">\(A^T v = \nabla f\)</span>. This is called the <em>adjoint</em> equation.</p>
<p>The partial derivatives in <span class="math inline">\(p\)</span> of <span class="math inline">\(g\)</span> are related to each partial derivative of <span class="math inline">\(dA\)</span> through:</p>
<p><span class="math display">\[
\frac{\partial g}{\partial p_k} = -v^T\frac{\partial A}{\partial p_k} x,
\]</span></p>
<p>as the scalar factor commutes through. With <span class="math inline">\(v\)</span> and <span class="math inline">\(x\)</span> solved for (via the adjoint equation and from solving <span class="math inline">\(Ax=b\)</span>) the partials in <span class="math inline">\(p_k\)</span> are computed with dot products. There are just two costly operations.</p>
<p><em>From right to left:</em></p>
<p>The value of <span class="math inline">\(x\)</span> can be solved for, as above, but computing the value of</p>
<p><span class="math display">\[
\frac{\partial g}{\partial p_k} =
-f'(x) \left(A^{-1} \frac{\partial A}{\partial p_k} x \right)
\]</span></p>
<p>requires a costly solve of <span class="math inline">\(A^{-1}\frac{\partial A}{\partial p_k} x\)</span> for each <span class="math inline">\(p_k\)</span>, and <span class="math inline">\(p\)</span> may have many components. This is the difference: left to right only has the solve of the one adjoint equation.</p>
<p>As mentioned above, the reverse mode offers advantages when there are many input parameters (<span class="math inline">\(p\)</span>) and a single output parameter.</p>
<section id="example-3" class="level5">
<h5 class="anchored" data-anchor-id="example-3">Example</h5>
<p>Suppose <span class="math inline">\(x(p)\)</span> solves some system of equations <span class="math inline">\(h(x(p),p) = 0\)</span> in <span class="math inline">\(R^n\)</span> (<span class="math inline">\(n\)</span> possibly just <span class="math inline">\(1\)</span>) and <span class="math inline">\(g(p) = f(x(p))\)</span> is some non-linear transformation of <span class="math inline">\(x\)</span>. What is the derivative of <span class="math inline">\(g\)</span> in <span class="math inline">\(p\)</span>?</p>
<p>Suppose the <em>implicit function theorem</em> applies to <span class="math inline">\(h(x,p) = 0\)</span>, that is <em>locally</em> the response <span class="math inline">\(x(p)\)</span> has a derivative, and moreover by the chain rule</p>
<p><span class="math display">\[
0 = \frac{\partial h}{\partial p} dp + \frac{\partial h}{\partial x} dx.
\]</span></p>
<p>Solving the above for <span class="math inline">\(dx\)</span> gives:</p>
<p><span class="math display">\[
dx = -\left(\frac{\partial h}{\partial x}\right)^{-1} \frac{\partial h}{\partial p} dp.
\]</span></p>
<p>The chain rule applied to <span class="math inline">\(g(p) = f(x(p))\)</span> then yields</p>
<p><span class="math display">\[
dg = f'(x) dx = - f'(x) \left(\frac{\partial h}{\partial x}\right)^{-1} \frac{\partial h}{\partial p} dp = -v^T\frac{\partial h}{\partial p} dp,
\]</span></p>
<p>by setting</p>
<p><span class="math display">\[
v^T = f'(x) \left(\frac{\partial h}{\partial x}\right)^{-1}.
\]</span></p>
<p>Here <span class="math inline">\(v\)</span> can be solved for by taking adjoints (as before). Let <span class="math inline">\(A = \partial h/\partial x\)</span>, then <span class="math inline">\(v^T = f'(x) A^{-1}\)</span> or <span class="math inline">\(v = (A^{-1})^T (f'(x))^t= (A^T)^{-1} \nabla f\)</span>. That is <span class="math inline">\(v\)</span> solves <span class="math inline">\(A^Tv=\nabla f\)</span>. As before it would take two solves to get both <span class="math inline">\(g\)</span> and its gradient.</p>
</section>
</section>
<section id="second-derivatives-hessian" class="level2" data-number="60.6">
<h2 data-number="60.6" class="anchored" data-anchor-id="second-derivatives-hessian"><span class="header-section-number">60.6</span> Second derivatives, Hessian</h2>
<p>We reference a theorem presented by <span class="citation" data-cites="CarlssonNikitinTroedssonWendt">Carlsson et al. (<a href="../references.html#ref-CarlssonNikitinTroedssonWendt" role="doc-biblioref">2025</a>)</span> for exposition with some modification</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Theorem 1. Let <span class="math inline">\(f:X \rightarrow Y\)</span>, where <span class="math inline">\(X,Y\)</span> are finite dimensional <em>inner product</em> spaces with elements in <span class="math inline">\(R\)</span>. Suppose <span class="math inline">\(f\)</span> is smooth (a certain number of derivatives). Then for each <span class="math inline">\(x\)</span> in <span class="math inline">\(X\)</span> there exists a unique linear operator, <span class="math inline">\(f'(x)\)</span>, and a unique <em>bilinear</em> <em>symmetric</em> operator <span class="math inline">\(f'': X \oplus X \rightarrow Y\)</span> such that</p>
<p><span class="math display">\[
f(x + \delta x) = f(x) + f'(x)[\delta x] + \frac{1}{2}f''(x)[\delta x, \delta x] + \mathscr(||\delta x ||^2).
\]</span></p>
</div>
</div>
</div>
<p>New terms include <em>bilinear</em>, <em>symmetric</em>, and <em>inner product</em>. An operator (<span class="math inline">\(X\oplus X \rightarrow Y\)</span>) is bilinear if it is a linear operator in each of its two arguments. Such an operator is <em>symmetric</em> if interchanging its two arguments makes no difference in its output. Finally, an <em>inner product</em> space is one with a generalization of the dot product. An inner product takes two vectors <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> and returns a scalar; it is denoted <span class="math inline">\(\langle x,y\rangle\)</span>; and has properties of symmetry, linearity, and non-negativity (<span class="math inline">\(\langle x,x\rangle \geq 0\)</span>, and equal <span class="math inline">\(0\)</span> only if <span class="math inline">\(x\)</span> is the zero vector.) Inner products can be used to form a norm (or length) for a vector through <span class="math inline">\(||x||^2 = \langle x,x\rangle\)</span>.</p>
<p>We reference this, as the values denoted <span class="math inline">\(f'\)</span> and <span class="math inline">\(f''\)</span> are <em>unique</em>. So if we identify them one way, we have identified them.</p>
<p>Specializing to <span class="math inline">\(X=R^n\)</span> and <span class="math inline">\(Y=R^1\)</span>, we have, <span class="math inline">\(f'=\nabla f^T\)</span> and <span class="math inline">\(f''\)</span> is the Hessian.</p>
<p>Take <span class="math inline">\(n=2\)</span>. Previously we wrote a formula for Taylor’s theorem for <span class="math inline">\(f:R^n \rightarrow R\)</span> that with <span class="math inline">\(n=2\)</span> has with <span class="math inline">\(x=\langle x_1,x_2\rangle\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
f(x + dx) &amp;= f(x) +
\frac{\partial f}{\partial x_1} dx_1 + \frac{\partial f}{\partial x_2} dx_2\\
&amp;{+}  \frac{1}{2}\left(
\frac{\partial^2 f}{\partial x_1^2}dx_1^2 +
\frac{\partial^2 f}{\partial x_1 \partial x_2}dx_1dx_2 +
\frac{\partial^2 f}{\partial x_2^2}dx_2^2
\right) + \mathscr{o}(dx).
\end{align*}
\]</span></p>
<p>We can see <span class="math inline">\(\nabla{f} \cdot dx = f'(x) dx\)</span> to tidy up part of the first line, and more over the second line can be seen to be a matrix product:</p>
<p><span class="math display">\[
[dx_1 dx_2]
\begin{bmatrix}
\frac{\partial^2 f}{\partial x_1^2} &amp;
\frac{\partial^2 f}{\partial x_1 \partial x_2}\\
\frac{\partial^2 f}{\partial x_2 \partial x_1} &amp;
\frac{\partial^2 f}{\partial x_2^2}
\end{bmatrix}
\begin{bmatrix}
dx_1\\
dx_2
\end{bmatrix}
= dx^T H dx,
\]</span></p>
<p><span class="math inline">\(H\)</span> being the <em>Hessian</em> with entries <span class="math inline">\(H_{ij} = \frac{\partial f}{\partial x_i \partial x_j}\)</span>.</p>
<p>This formula—<span class="math inline">\(f(x+dx)-f(x) \approx f'(x)dx + dx^T H dx\)</span>—is valid for any <span class="math inline">\(n\)</span>, showing <span class="math inline">\(n=2\)</span> was just for ease of notation when expressing in the coordinates and not as matrices.</p>
<p>By uniqueness, we have under these assumptions that the Hessian is <em>symmetric</em> and the expression <span class="math inline">\(dx^T H dx\)</span> is a <em>bilinear</em> form, which we can identify as <span class="math inline">\(f''(x)[dx,dx]\)</span>.</p>
<p>That the Hessian is symmetric could also be derived under these assumptions by directly computing that the mixed partials can have their order exchanged. But in this framework, as explained by <span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> (and shown later) it is a result of the underlying vector space having an addition that is commutative (e.g.&nbsp;<span class="math inline">\(u+v = v+u\)</span>).</p>
<p>The mapping <span class="math inline">\((u,v) \rightarrow u^T A v\)</span> for a matrix <span class="math inline">\(A\)</span> is bilinear. For a fixed <span class="math inline">\(u\)</span>, it is linear as it can be viewed as <span class="math inline">\((u^TA)[v]\)</span> and matrix multiplication is linear. Similarly for a fixed <span class="math inline">\(v\)</span>.</p>
<p><span class="citation" data-cites="BrightEdelmanJohnson">Bright, Edelman, and Johnson (<a href="../references.html#ref-BrightEdelmanJohnson" role="doc-biblioref">2025</a>)</span> extend this characterization to a broader setting.</p>
<p>We have for some function <span class="math inline">\(f\)</span></p>
<p><span class="math display">\[
df = f(x + dx) - f(x) = f'(x)[dx]
\]</span></p>
<p>Then if <span class="math inline">\(d\tilde{x}\)</span> is another differential change with the same shape as <span class="math inline">\(x\)</span> we can look at the differential of <span class="math inline">\(f'(x)\)</span>:</p>
<p><span class="math display">\[
d(f') = f'(x + d\tilde{x}) - f'(x) = f''(x)[d\tilde{x}]
\]</span></p>
<p>Now, <span class="math inline">\(d(f')\)</span> has the same shape as <span class="math inline">\(f'\)</span>, a linear operator, hence <span class="math inline">\(d(f')\)</span> is also a linear operator. Acting on <span class="math inline">\(dx\)</span>, we have</p>
<p><span class="math display">\[
d(f')[dx] = f''(x)[d\tilde{x}][dx] = f''(x)[d\tilde{x}, dx].
\]</span></p>
<p>The last equality a definition. As <span class="math inline">\(f''\)</span> is linear in the the application to <span class="math inline">\(d\tilde{x}\)</span> and also linear in application to <span class="math inline">\(dx\)</span>, <span class="math inline">\(f''(x)\)</span> is a bilinear operator.</p>
<p>Moreover, the following shows it is <em>symmetric</em>:</p>
<p><span class="math display">\[
\begin{align*}
f''(x)[d\tilde{x}][dx] &amp;= (f'(x + d\tilde{x}) - f'(x))[dx]\\
&amp;= f'(x + d\tilde{x})[dx] - f'(x)[dx]\\
&amp;= (f(x + d\tilde{x} + dx) - f(x + d\tilde{x})) - (f(x+dx) - f(x))\\
&amp;= (f(x + dx + d\tilde{x}) - f(x + dx)) - (f(x +  d\tilde{x}) - f(x))\\
&amp;= f'(x + dx)[d\tilde{x}] - f'(x)[d\tilde{x}]\\
&amp;= f''(x)[dx][d\tilde{x}]
\end{align*}
\]</span></p>
<p>So <span class="math inline">\(f''(x)[d\tilde{x},dx] = f''(x)[dx, d\tilde{x}]\)</span>. The key is the commutivity of vector addition to say <span class="math inline">\(dx + d\tilde{x} = d\tilde{x} + dx\)</span> in the third line.</p>
<section id="example-hessian-is-symmetric" class="level5">
<h5 class="anchored" data-anchor-id="example-hessian-is-symmetric">Example: Hessian is symmetric</h5>
<p>As mentioned earlier, the Hessian is the matrix arising from finding the second derivative of a multivariate, scalar-valued function <span class="math inline">\(f:R^n \rightarrow R\)</span>. As a bilinear form on a finite vector space, it can be written as <span class="math inline">\(\tilde{x}^T A x\)</span>. As this second derivative is symmetric, and this value above a scalar, it follows that <span class="math inline">\(\tilde{x}^T A x = \tilde{x}^T A^T x\)</span>. That is <span class="math inline">\(H = A\)</span> must also be symmetric from general principles.</p>
</section>
<section id="example-second-derivative-of-xtax" class="level5">
<h5 class="anchored" data-anchor-id="example-second-derivative-of-xtax">Example: second derivative of <span class="math inline">\(x^TAx\)</span></h5>
<p>Consider an expression from earlier <span class="math inline">\(f(x) = x^T A x\)</span> for some constant <span class="math inline">\(A\)</span>.</p>
<p>We have seen that <span class="math inline">\(f' = (\nabla f)^T = x^T(A+A^T)\)</span>. That is <span class="math inline">\(\nabla f = (A^T+A)x\)</span> is linear in <span class="math inline">\(x\)</span>. The Jacobian of <span class="math inline">\(\nabla f\)</span> is the Hessian, <span class="math inline">\(H = f'' = A + A^T\)</span>.</p>
</section>
<section id="example-second-derivative-of-textdeta" class="level5">
<h5 class="anchored" data-anchor-id="example-second-derivative-of-textdeta">Example: second derivative of <span class="math inline">\(\text{det}(A)\)</span></h5>
<p>Consider <span class="math inline">\(f(A) = \text{det}(A)\)</span>. We saw previously that:</p>
<p><span class="math display">\[
\begin{align*}
\text{tr}(A + B) &amp;= \text{tr}(A) + \text{tr}(B)\\
\text{det}(A + dA') &amp;= \text{det}(A) + \text{det}(A)\text{tr}(A^{-1}dA')\\
(A + dA') &amp;= A^{-1} - A^{-1} dA' A^{-1}
\end{align*}
\]</span></p>
<p>These are all used to simplify:</p>
<p><span class="math display">\[
\begin{align*}
\text{det}(A+dA')&amp;\text{tr}((A + dA')^{-1} dA) - \text{det}(A) \text{tr}(A^{-1}dA) \\
&amp;= \left(
\text{det}(A) + \text{det}(A)\text{tr}(A^{-1}dA')
\right)
\text{tr}((A^{-1} - A^{-1}dA' A^{-1})dA)\\
&amp;\quad{-} \text{det}(A) \text{tr}(A^{-1}dA) \\
&amp;=
\textcolor{blue}{\text{det}(A) \text{tr}(A^{-1}dA)}\\
&amp;\quad{+} \text{det}(A)\text{tr}(A^{-1}dA')\text{tr}(A^{-1}dA) \\
&amp;\quad{-} \text{det}(A)\text{tr}(A^{-1}dA' A^{-1}dA)\\
&amp;\quad{-} \textcolor{red}{\text{det}(A)\text{tr}(A^{-1}dA')\text{tr}(A^{-1}dA' A^{-1}dA)}\\
&amp;\quad{-} \textcolor{blue}{\text{det}(A) \text{tr}(A^{-1}dA)} \\
&amp;= \text{det}(A)\text{tr}(A^{-1}dA')\text{tr}(A^{-1}dA) - \text{det}(A)\text{tr}(A^{-1}dA' A^{-1}dA)\\
&amp;\quad{+} \textcolor{red}{\text{third order term}}
\end{align*}
\]</span></p>
<p>So, after dropping the third-order term, we see:</p>
<p><span class="math display">\[
f''(A)[dA,dA']
= \text{det}(A)\text{tr}(A^{-1}dA')\text{tr}(A^{-1}dA) -
\text{det}(A)\text{tr}(A^{-1}dA' A^{-1}dA).
\]</span></p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-BrightEdelmanJohnson" class="csl-entry" role="listitem">
Bright, Paige, Alan Edelman, and Steven G. Johnson. 2025. <span>“Matrix Calculus (for Machine Learning and Beyond).”</span> <a href="https://arxiv.org/abs/2501.14787">https://arxiv.org/abs/2501.14787</a>.
</div>
<div id="ref-CarlssonNikitinTroedssonWendt" class="csl-entry" role="listitem">
Carlsson, Marcus, Viktor Nikitin, Erik Troedsson, and Herwig Wendt. 2025. <span>“The Bilinear Hessian for Large Scale Optimization.”</span> <a href="https://arxiv.org/abs/2502.03070">https://arxiv.org/abs/2502.03070</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../differentiable_vector_calculus/vector_fields.html" class="pagination-link" aria-label="Functions $R^n \rightarrow R^m$">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Functions <span class="math inline">\(R^n \rightarrow R^m\)</span></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../differentiable_vector_calculus/plots_plotting.html" class="pagination-link" aria-label="2D and 3D plots in Julia with Plots">
        <span class="nav-page-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">2D and 3D plots in Julia with Plots</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2022-25, John Verzani</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/edit/main/quarto/differentiable_vector_calculus/matrix_calculus_notes.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jverzani/CalculusWithJuliaNotes.jl/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>